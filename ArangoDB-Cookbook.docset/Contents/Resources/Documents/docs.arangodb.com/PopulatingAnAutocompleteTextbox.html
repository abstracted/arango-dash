<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Populating a Textbox | Cookbook</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.5.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    
        <link rel="stylesheet" href="./styles/website.css">
    

        
    
    
    <link rel="next" href="./ExportingData.html" />
    
    
    <link rel="prev" href="./UsingArangoDBWithSailsJS.html" />
    

        <script type="text/javascript" src="styles/header.js"></script><link rel="stylesheet" type="text/css" href="styles/header.css">
    </head>
    <body>
        
        
    <div class="book" data-level="6.3" data-chapter-title="Populating a Textbox" data-filepath="PopulatingAnAutocompleteTextbox.md" data-basepath="." data-revision="Tue Jan 19 2016 13:30:25 GMT+0100 (CET)">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="ModulDocumentInheritance.html">
            
                
                    <a href="./ModulDocumentInheritance.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Modelling Document Inheritance
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="AccessingShapesData.html">
            
                
                    <a href="./AccessingShapesData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Accessing Shapes Data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" >
            
            <span><b>3.</b> AQL</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="JoinsInAQL.html">
            
                
                    <a href="./JoinsInAQL.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Using Joins in AQL
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="UsingDynamicAttributeNames.html">
            
                
                    <a href="./UsingDynamicAttributeNames.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Using Dynamic Attribute Names
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="FindingLeafNodesGraph.html">
            
                
                    <a href="./FindingLeafNodesGraph.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Finding Leaf Nodes in a Graph
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="FilteringNodesGraph.html">
            
                
                    <a href="./FilteringNodesGraph.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        Filtering Nodes in a Graph
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="CountingNodesEfficientlyGraph.html">
            
                
                    <a href="./CountingNodesEfficientlyGraph.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Counting Nodes efficiently
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="CreatingTestDataAQL.html">
            
                
                    <a href="./CreatingTestDataAQL.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        Creating Test-data using AQL
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="DiffingDocuments.html">
            
                
                    <a href="./DiffingDocuments.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.7.</b>
                        
                        Diffing Documents
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="AvoidingInjection.html">
            
                
                    <a href="./AvoidingInjection.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.8.</b>
                        
                        Avoiding Parameter Injection
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="MultilineQueryStrings.html">
            
                
                    <a href="./MultilineQueryStrings.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.9.</b>
                        
                        Multiline Query Strings
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" >
            
            <span><b>4.</b> Graph-based Recipes</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="Fulldepth.html">
            
                
                    <a href="./Fulldepth.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Fulldepth Graph-Traversal
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="FindingConnectedVerticesForSubgraphs.html">
            
                
                    <a href="./FindingConnectedVerticesForSubgraphs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Vertices for Subgraphs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="JavaDriverGraphExampleVertex.html">
            
                
                    <a href="./JavaDriverGraphExampleVertex.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        Vertex example with Java
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="JavaDriverBaseDocument.html">
            
                
                    <a href="./JavaDriverBaseDocument.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        Accessing base documents with Java
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="UsingCustomVisitorFromNodeJs.html">
            
                
                    <a href="./UsingCustomVisitorFromNodeJs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        Using a custom Visitor
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="GraphExampleActorsAndMovies.html">
            
                
                    <a href="./GraphExampleActorsAndMovies.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        Example AQL Queries for Graphs
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" >
            
            <span><b>5.</b> Foxx Framework</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="FoxxFirstSteps.html">
            
                
                    <a href="./FoxxFirstSteps.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        My first Foxx App
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="FoxxFirstStepsLegacy.html">
            
                
                    <a href="./FoxxFirstStepsLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        My first Foxx App pre-2.4
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="FoxxAuth.html">
            
                
                    <a href="./FoxxAuth.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        Adding Authentication
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="FoxxAuthLegacy.html">
            
                
                    <a href="./FoxxAuthLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        Adding Authentication pre-2.5
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="MakingRequests.html">
            
                
                    <a href="./MakingRequests.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                        Using external APIs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="FoxxQueues.html">
            
                
                    <a href="./FoxxQueues.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.</b>
                        
                        Background jobs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.7" data-path="FoxxQueuesLegacy.html">
            
                
                    <a href="./FoxxQueuesLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.7.</b>
                        
                        legacy background jobs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.8" data-path="FoxxCustomQueueJobsLegacy.html">
            
                
                    <a href="./FoxxCustomQueueJobsLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.8.</b>
                        
                        legacy custom Background jobs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.9" data-path="FoxxScripts.html">
            
                
                    <a href="./FoxxScripts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.9.</b>
                        
                        Creating a Foxx script
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.10" data-path="FoxxCustomQueueJobs.html">
            
                
                    <a href="./FoxxCustomQueueJobs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.10.</b>
                        
                        Custom job types for Queues
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.11" data-path="FoxxGeneratorFirstSteps.html">
            
                
                    <a href="./FoxxGeneratorFirstSteps.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.11.</b>
                        
                        My first FoxxGenerator App
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.12" data-path="FoxxDeploy.html">
            
                
                    <a href="./FoxxDeploy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.12.</b>
                        
                        How to deploy a Foxx App
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.13" data-path="MakingFoxxAppAccessible.html">
            
                
                    <a href="./MakingFoxxAppAccessible.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.13.</b>
                        
                        Apps accessible from the Web
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.14" data-path="FoxxApiKeys.html">
            
                
                    <a href="./FoxxApiKeys.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.14.</b>
                        
                        API-Key Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.15" data-path="FoxxBinaryHttpPost.html">
            
                
                    <a href="./FoxxBinaryHttpPost.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.15.</b>
                        
                        Binary HTTP documents
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.16" data-path="FoxxTesting.html">
            
                
                    <a href="./FoxxTesting.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.16.</b>
                        
                        Foxx Testing
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" >
            
            <span><b>6.</b> Use Cases, Examples</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="CrawlingGithubPromises.html">
            
                
                    <a href="./CrawlingGithubPromises.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Crawling Github with Promises
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="UsingArangoDBWithSailsJS.html">
            
                
                    <a href="./UsingArangoDBWithSailsJS.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        Using ArangoDB with Sails.js
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="6.3" data-path="PopulatingAnAutocompleteTextbox.html">
            
                
                    <a href="./PopulatingAnAutocompleteTextbox.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.</b>
                        
                        Populating a Textbox
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="ExportingData.html">
            
                
                    <a href="./ExportingData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.4.</b>
                        
                        Exporting Data
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" >
            
            <span><b>7.</b> ArangoDB Setup / Administration</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="UsingAuthentication.html">
            
                
                    <a href="./UsingAuthentication.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        Using Authentication
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="ImportingData.html">
            
                
                    <a href="./ImportingData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                        Importing Data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="ReplicatingData.html">
            
                
                    <a href="./ReplicatingData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.3.</b>
                        
                        Replicating Data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.4" data-path="XCopyInstallWindows.html">
            
                
                    <a href="./XCopyInstallWindows.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.4.</b>
                        
                        XCopy Install Windows
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.5" data-path="Compiling.html">
            
                
                    <a href="./Compiling.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.</b>
                        
                        Compiling / Build
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.5.1" data-path="CompilingOnDebian.html">
            
                
                    <a href="./CompilingOnDebian.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.1.</b>
                        
                        Compile on Debian
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.5.2" data-path="CompilingUnderWindows.html">
            
                
                    <a href="./CompilingUnderWindows.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.2.</b>
                        
                        Compile on Windows
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.5.3" data-path="CompilingUnderWindowsLegacy.html">
            
                
                    <a href="./CompilingUnderWindowsLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.3.</b>
                        
                        Compile on Windows pre-2.4
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.5.4" data-path="RunningCustomBuild.html">
            
                
                    <a href="./RunningCustomBuild.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.4.</b>
                        
                        Running Custom Build
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" >
            
            <span><b>8.</b> Cloud, DCOS and Docker</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="RunningOnAWS.html">
            
                
                    <a href="./RunningOnAWS.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        Running on AWS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="UpdateArangoDBOnAWS.html">
            
                
                    <a href="./UpdateArangoDBOnAWS.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        Update on AWS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="UsingArangoDBAzure.html">
            
                
                    <a href="./UsingArangoDBAzure.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                        Running on Azure
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.4" data-path="RunningInDockerContainer.html">
            
                
                    <a href="./RunningInDockerContainer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                        Docker ArangoDB
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.5" data-path="UsingArangoDBNodeJSDocker.html">
            
                
                    <a href="./UsingArangoDBNodeJSDocker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                        Docker with NodeJS App
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.6" data-path="UsingArangoDBInGiantSwarm.html">
            
                
                    <a href="./UsingArangoDBInGiantSwarm.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.</b>
                        
                        In the GiantSwarm
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.7" data-path="UsingArangoDBMesosphere.html">
            
                
                    <a href="./UsingArangoDBMesosphere.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.7.</b>
                        
                        ArangoDB in Mesos
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" >
            
            <span><b>9.</b> Monitoring</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1" data-path="MonitoringWithCollectd.html">
            
                
                    <a href="./MonitoringWithCollectd.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                        Monitoring with Collectd
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="MonitoringSlaveStatus.html">
            
                
                    <a href="./MonitoringSlaveStatus.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                        Collectd - Replication Slaves
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="MonitoringTrafficWithIPAccounting.html">
            
                
                    <a href="./MonitoringTrafficWithIPAccounting.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.3.</b>
                        
                        Collectd - Network usage
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.4" data-path="MonitoringOtherRelevantMetrics.html">
            
                
                    <a href="./MonitoringOtherRelevantMetrics.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.4.</b>
                        
                        Collectd - more Metrics
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.5" data-path="MonitoringFoxxApps.html">
            
                
                    <a href="./MonitoringFoxxApps.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.5.</b>
                        
                        Collectd - Monitoring Foxx
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Cookbook</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="populating-an-autocomplete-textbox">Populating an autocomplete textbox</h1>
<h2 id="problem">Problem</h2>
<p>I want to populate an autocomplete textbox with values from a collection. The completions
should adjust dynamically based on user input.</p>
<h2 id="solution">Solution</h2>
<p>Use a web framework for the client-side autocomplete rendering and event processing. Use
a collection with a (sorted) skiplist index and a range query on it to efficiently fetch
the completion values dynamically. Connect the two using a simple Foxx route.</p>
<h3 id="install-an-example-app">Install an example app</h3>
<p><a href="https://github.com/jsteemann/autocomplete" target="_blank">This app</a> contains a jquery-powered web page
with an autocomplete textbox. It uses <a href="http://jqueryui.com/autocomplete/" target="_blank">jquery autocomplete</a>,
but every other web framework will also do.</p>
<p>The app can be installed as follows:</p>
<ul>
<li>in the ArangoDB web interface, switch into the <strong>Applications</strong> tab</li>
<li>there, click <em>Add Application</em></li>
<li>switch on the <em>Github</em> tab</li>
<li>for <em>Repository</em>, enter <code>jsteemann/autocomplete</code></li>
<li>for <em>Version</em>, enter <code>master</code></li>
<li>click <em>Install</em></li>
</ul>
<p>Now enter a mountpoint for the application. This is the URL path under which the
application will become available. For the example app, the mountpoint does not matter.
The web page in the example app assumes it is served by ArangoDB, too. So it uses a
relative URL <code>autocomplete</code>. This is easiest to set up, but in reality you might want
to have your web page served by a different server. In this case, your web page will
have to call the app mountpoint you just entered.</p>
<p>To see the example app in action, click on <strong>Open</strong>. The autocomplete textbox should be
populated with server data when at least two letters are entered.</p>
<h3 id="backend-code-setup-script">Backend code, setup script</h3>
<p>The app also contains a backend route <code>/autocomplete</code> which is called by the web page to
fetch completions based on user input. The HTML code for the web page is 
<a href="https://github.com/jsteemann/autocomplete/blob/master/assets/index.html" target="_blank">here</a>.</p>
<p>Contained in the app is a <a href="https://github.com/jsteemann/autocomplete/blob/master/scripts/setup.js" target="_blank">setup script</a>
that will create a collection named <code>completions</code> and load some initial data into it. The
example app provides autocompletion for US city names, and the setup script populates the
collection with about 10K city names.</p>
<p>The setup script also <a href="https://github.com/jsteemann/autocomplete/blob/master/scripts/setup.js#L10561" target="_blank">creates a skiplist index on the lookup attribute</a>,
so this attribute can be used for efficient filtering and sorting later.
The <code>lookup</code> attribute contains the city names already lower-cased, and the original 
(<em>pretty</em>) names are stored in attribute <code>pretty</code>. This attribute will be returned to
users.</p>
<h3 id="backend-code-foxx-route-controller">Backend code, Foxx route controller</h3>
<p>The app contains a <a href="https://github.com/jsteemann/autocomplete/blob/master/demo.js" target="_blank">controller</a>.
The backend action <code>/autocomplete</code> that is called by the web page is also contained herein:</p>
<pre><code class="lang-js">controller.get(<span class="hljs-string">&quot;/autocomplete&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-comment">// search phrase entered by user</span>
  <span class="hljs-keyword">var</span> searchString = req.params(<span class="hljs-string">&quot;q&quot;</span>).trim() || <span class="hljs-string">&quot;&quot;</span>;
  <span class="hljs-comment">// lower bound for search range</span>
  <span class="hljs-keyword">var</span> begin = searchString.replace(<span class="hljs-regexp">/[^a-zA-Z]/g</span>, <span class="hljs-string">&quot; &quot;</span>).toLowerCase();
  <span class="hljs-keyword">if</span> (begin.length === <span class="hljs-number">0</span>) {
    <span class="hljs-comment">// search phrase is empty - no need to perfom a search at all</span>
    res.json([]);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-comment">// upper bound for search range</span>
  <span class="hljs-keyword">var</span> end = begin.substr(<span class="hljs-number">0</span>, begin.length - <span class="hljs-number">1</span>) + <span class="hljs-built_in">String</span>.fromCharCode(begin.charCodeAt(begin.length - <span class="hljs-number">1</span>) + <span class="hljs-number">1</span>);
  <span class="hljs-comment">// bind parameters for query</span>
  <span class="hljs-keyword">var</span> queryParams = {
    <span class="hljs-string">&quot;@collection&quot;</span> : <span class="hljs-string">&quot;completions&quot;</span>,
    <span class="hljs-string">&quot;begin&quot;</span> : begin,
    <span class="hljs-string">&quot;end&quot;</span> : end
  };
  <span class="hljs-comment">// the search query</span>
  <span class="hljs-keyword">var</span> query = <span class="hljs-string">&quot;FOR doc IN @@collection FILTER doc.lookup &gt;= @begin &amp;&amp; doc.lookup &lt; @end SORT doc.lookup RETURN { label: doc.pretty, value: doc.pretty, id: doc._key }&quot;</span>;
  res.json(db._query(query, queryParams).toArray());
}
</code></pre>
<p>The backend code first fetches the search string from the URL parameter <code>q</code>. This is what the
web page will send us. </p>
<p>Based on the search string, a lookup range is calculated. First of all, the search string is
lower-cased and all non-letter characters are removed from it. The resulting string is the
lower bound for the lookup. For the upper bound, we can use the lower bound with its last 
letter character code increased by one.</p>
<p>For example, if the user entered <code>Los A</code> into the textbox, the web page will send us the string
<code>Los A</code> in URL parameter <code>q</code>. Lower-casing and removing non-letter characters from the string,
we&apos;ll get <code>losa</code>. This is the lower bound. The upper bound is <code>losa</code>, with its last letter adjusted
to <code>b</code> (i.e. <code>losb</code>).</p>
<p>Finally, the lower and upper bounds are inserted into the following query using bind parameters
<code>@begin</code> and <code>@end</code>:</p>
<pre><code>FOR doc IN @@collection 
  FILTER doc.lookup &gt;= @begin &amp;&amp; doc.lookup &lt; @end 
  SORT doc.lookup 
  RETURN { 
    label: doc.pretty, 
    value: doc.pretty, 
    id: doc._key 
  }
</code></pre><p>The city names in the lookup range will be returned sorted. For each city, three values are
returned (the <code>id</code> contains the document key, the other two values are for display purposes).
Other frameworks may require a different return format, but that can easily be done by
adjusting the AQL query.</p>
<p><strong>Author:</strong> <a href="https://github.com/jsteemann" target="_blank">Jan Steemann</a></p>
<p><strong>Tags</strong>: #aql #autocomplete #jquery</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./UsingArangoDBWithSailsJS.html" class="navigation navigation-prev " aria-label="Previous page: Using ArangoDB with Sails.js"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./ExportingData.html" class="navigation navigation-next " aria-label="Next page: Exporting Data"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-piwik/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"piwik":{"URL":"www.arangodb.com/piwik/","siteId":12},"addcssjs":{"js":["styles/header.js"],"css":["styles/header.css"]},"highlight":{},"search":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        <script type="text/javascript">var _paq = _paq || [];_paq.push(['trackPageView']);_paq.push(['enableLinkTracking']);(function() {var u=(("https:" == document.location.protocol) ? "https" : "http") + "://www.arangodb.com/piwik/";_paq.push(['setTrackerUrl', u+'piwik.php']);_paq.push(['setSiteId', 12]);var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';g.defer=true; g.async=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);})();</script><noscript><p><img src="http://www.arangodb.com/piwik/piwik.php?idsite=12" style="border:0;" alt="" /></p></noscript>
    </body>
    
</html>
