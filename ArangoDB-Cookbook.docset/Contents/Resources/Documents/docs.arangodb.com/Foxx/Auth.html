<!DOCTYPE HTML>
<html lang="en" >
    <!-- Start book ArangoDB Cookbook -->
    <head>
        <!-- head:start -->
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Adding Authentication | ArangoDB Cookbook</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        <meta name="author" content="ArangoDB GmbH">
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-toggle-chapters/toggle.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    
        <link rel="stylesheet" href="../styles/website.css">
    

        
    
    
    <link rel="next" href="../Foxx/AuthLegacy.html" />
    
    
    <link rel="prev" href="../Foxx/FirstStepsLegacy.html" />
    

        <!-- head:end -->
<script type="text/javascript" src="../styles/header.js"></script><link rel="stylesheet" type="text/css" href="../styles/header.css">
    </head>
    <body>
        <!-- body:start -->
<div id="header">
  <div id="logo">
    <a href="https://arangodb.com/">
      <img src="https://docs.arangodb.com/assets/arangodb_logo_2016.png">
    </a>
  </div>
  <div id="logo-small">
    <a href="https://arangodb.com/">
      <img src="https://docs.arangodb.com/assets/arangodb_logo_small_2016.png">
    </a>
  </div>
  <!--
  <select id="version-switcher">
    <option value="devel">VERSION_NUMBER</option>
    <option value="2.8">v2.8</option>
    <option value="2.7">v2.7</option>
    <option value="2.6">v2.6</option>
    <option value="2.5">v2.5</option>
    <option value="2.4">v2.4</option>
    <option value="2.3">v2.3</option>
    <option value="2.2">v2.2</option>
    <option value="2.1">v2.1</option>
  </select>
  -->
  <div class="google-search">
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
  <ul id="navmenu">
    <li>
      <a href="https://docs.arangodb.com/devel/Manual/index.html">Manual</a>
    </li>
    <li>
      <a href="https://docs.arangodb.com/devel/AQL/index.html">AQL</a>
    </li>
    <li>
      <a href="https://docs.arangodb.com/devel/HTTP/index.html">HTTP</a>
    </li>
    <li class="active-tab">
      <a href="https://docs.arangodb.com/cookbook">Cookbook</a>
    </li>
    <li class="socialIcons">
      <a href="https://github.com/ArangoDB/ArangoDB/issues" target="blank" name="github">
        <i title="GitHub" class="fa fa-github"></i>
      </a>
    </li>
    <li class="socialIcons">
      <a href="http://stackoverflow.com/questions/tagged/arangodb" target="blank" name="stackoverflow">
        <i title="Stackoverflow" class="fa fa-stack-overflow"></i>
      </a>
    </li>
    <li class="socialIcons socialIcons-googlegroups">
      <a href="https://groups.google.com/forum/#!forum/arangodb" target="blank" name="google groups">
        <img title="Google Groups" alt="Google Groups" src="https://docs.arangodb.com/assets/googlegroupsIcon.png" />
      </a>
    </li>
  </ul>
</div>
        
    <div class="book"
        data-level="5.3"
        data-chapter-title="Adding Authentication"
        data-filepath="Foxx/Auth.md"
        data-basepath=".."
        data-revision="Thu Jun 02 2016 12:54:56 GMT+0000 (UTC)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="DocumentInheritance.html">
            
                
                    <a href="../DocumentInheritance.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Modelling Document Inheritance
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="AccessingShapesData.html">
            
                
                    <a href="../AccessingShapesData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Accessing Shapes Data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="AQL/index.html">
            
                
                    <a href="../AQL/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        AQL
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="AQL/Joins.html">
            
                
                    <a href="../AQL/Joins.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Using Joins in AQL
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="AQL/DynamicAttributeNames.html">
            
                
                    <a href="../AQL/DynamicAttributeNames.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Using Dynamic Attribute Names
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="AQL/CreatingTestData.html">
            
                
                    <a href="../AQL/CreatingTestData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Creating Test-data using AQL
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="AQL/DiffingDocuments.html">
            
                
                    <a href="../AQL/DiffingDocuments.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        Diffing Documents
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="AQL/AvoidingInjection.html">
            
                
                    <a href="../AQL/AvoidingInjection.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Avoiding Parameter Injection
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="AQL/MultilineQueryStrings.html">
            
                
                    <a href="../AQL/MultilineQueryStrings.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        Multiline Query Strings
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="Graph/index.html">
            
                
                    <a href="../Graph/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Graph
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="Graph/FindingLeafNodesAql.html">
            
                
                    <a href="../Graph/FindingLeafNodesAql.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Finding Leaf Nodes with AQL
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="Graph/FilteringNodesAql.html">
            
                
                    <a href="../Graph/FilteringNodesAql.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Filtering Nodes with AQL
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="Graph/CountingNodesEfficientlyAql.html">
            
                
                    <a href="../Graph/CountingNodesEfficientlyAql.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        Counting Nodes efficiently with AQL
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="Graph/FulldepthTraversal.html">
            
                
                    <a href="../Graph/FulldepthTraversal.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        Fulldepth Graph-Traversal
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="Graph/FindingConnectedVerticesForSubgraphs.html">
            
                
                    <a href="../Graph/FindingConnectedVerticesForSubgraphs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        Vertices for Subgraphs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="Graph/JavaDriverGraphExampleVertex.html">
            
                
                    <a href="../Graph/JavaDriverGraphExampleVertex.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        Vertex example with Java
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="Graph/JavaDriverBaseDocument.html">
            
                
                    <a href="../Graph/JavaDriverBaseDocument.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.</b>
                        
                        Accessing base documents with Java
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="Graph/CustomVisitorFromNodeJs.html">
            
                
                    <a href="../Graph/CustomVisitorFromNodeJs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.8.</b>
                        
                        Using a custom Visitor
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.9" data-path="Graph/ExampleActorsAndMovies.html">
            
                
                    <a href="../Graph/ExampleActorsAndMovies.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.</b>
                        
                        Example AQL Queries for Graphs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.10" data-path="Graph/JavaDriverXmlData.html">
            
                
                    <a href="../Graph/JavaDriverXmlData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.10.</b>
                        
                        Add XML data to ArangoDB with Java
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="Foxx/index.html">
            
                
                    <a href="../Foxx/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Foxx
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="Foxx/FirstSteps.html">
            
                
                    <a href="../Foxx/FirstSteps.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        My first Foxx App
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="Foxx/FirstStepsLegacy.html">
            
                
                    <a href="../Foxx/FirstStepsLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        My first Foxx App pre-2.4
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="5.3" data-path="Foxx/Auth.html">
            
                
                    <a href="../Foxx/Auth.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        Adding Authentication
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="Foxx/AuthLegacy.html">
            
                
                    <a href="../Foxx/AuthLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        Adding Authentication pre-2.5
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="Foxx/MakingRequests.html">
            
                
                    <a href="../Foxx/MakingRequests.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                        Using external APIs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="Foxx/Queues.html">
            
                
                    <a href="../Foxx/Queues.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.</b>
                        
                        Background jobs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.7" data-path="Foxx/QueuesLegacy.html">
            
                
                    <a href="../Foxx/QueuesLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.7.</b>
                        
                        Legacy background jobs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.8" data-path="Foxx/CustomQueueJobsLegacy.html">
            
                
                    <a href="../Foxx/CustomQueueJobsLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.8.</b>
                        
                        Legacy custom Background jobs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.9" data-path="Foxx/Scripts.html">
            
                
                    <a href="../Foxx/Scripts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.9.</b>
                        
                        Creating a Foxx script
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.10" data-path="Foxx/CustomQueueJobs.html">
            
                
                    <a href="../Foxx/CustomQueueJobs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.10.</b>
                        
                        Custom job types for Queues
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.11" data-path="Foxx/GeneratorFirstSteps.html">
            
                
                    <a href="../Foxx/GeneratorFirstSteps.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.11.</b>
                        
                        My first FoxxGenerator App
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.12" data-path="Foxx/Deploy.html">
            
                
                    <a href="../Foxx/Deploy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.12.</b>
                        
                        How to deploy a Foxx App
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.13" data-path="Foxx/MakingAppAccessible.html">
            
                
                    <a href="../Foxx/MakingAppAccessible.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.13.</b>
                        
                        Apps accessible from the Web
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.14" data-path="Foxx/ApiKeys.html">
            
                
                    <a href="../Foxx/ApiKeys.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.14.</b>
                        
                        API-Key Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.15" data-path="Foxx/BinaryFileUploads.html">
            
                
                    <a href="../Foxx/BinaryFileUploads.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.15.</b>
                        
                        Handling Binary HTTP documents in Foxx
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.16" data-path="Foxx/BinaryHttpPost.html">
            
                
                    <a href="../Foxx/BinaryHttpPost.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.16.</b>
                        
                        Sending Binary HTTP documents from Foxx
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.17" data-path="Foxx/Testing.html">
            
                
                    <a href="../Foxx/Testing.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.17.</b>
                        
                        Foxx Testing
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="UseCases/index.html">
            
                
                    <a href="../UseCases/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Use Cases / Examples
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="UseCases/CrawlingGithubPromises.html">
            
                
                    <a href="../UseCases/CrawlingGithubPromises.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Crawling Github with Promises
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="UseCases/SailsJS.html">
            
                
                    <a href="../UseCases/SailsJS.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        Using ArangoDB with Sails.js
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="UseCases/PopulatingAnAutocompleteTextbox.html">
            
                
                    <a href="../UseCases/PopulatingAnAutocompleteTextbox.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.</b>
                        
                        Populating a Textbox
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="UseCases/ExportingData.html">
            
                
                    <a href="../UseCases/ExportingData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.4.</b>
                        
                        Exporting Data
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="Administration/index.html">
            
                
                    <a href="../Administration/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Administration
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="Administration/Authentication.html">
            
                
                    <a href="../Administration/Authentication.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        Using Authentication
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="Administration/ImportingData.html">
            
                
                    <a href="../Administration/ImportingData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                        Importing Data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="Administration/ReplicatingData.html">
            
                
                    <a href="../Administration/ReplicatingData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.3.</b>
                        
                        Replicating Data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.4" data-path="Administration/XCopyInstallWindows.html">
            
                
                    <a href="../Administration/XCopyInstallWindows.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.4.</b>
                        
                        XCopy Install Windows
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" data-path="Compiling/index.html">
            
                
                    <a href="../Compiling/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Compiling / Build
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="Compiling/Debian.html">
            
                
                    <a href="../Compiling/Debian.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        Compile on Debian
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="Compiling/Windows.html">
            
                
                    <a href="../Compiling/Windows.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        Compile on Windows
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="Compiling/WindowsLegacy.html">
            
                
                    <a href="../Compiling/WindowsLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                        Compile on Windows pre-2.4
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.4" data-path="Compiling/RunningCustomBuild.html">
            
                
                    <a href="../Compiling/RunningCustomBuild.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                        Running Custom Build
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.5" data-path="Compiling/Windows30.html">
            
                
                    <a href="../Compiling/Windows30.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                        Compile 3.0 on Windows (devel)
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="Cloud/index.html">
            
                
                    <a href="../Cloud/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        Cloud, DCOS and Docker
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1" data-path="Cloud/Aws.html">
            
                
                    <a href="../Cloud/Aws.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                        Running on AWS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="Cloud/AwsUpdate.html">
            
                
                    <a href="../Cloud/AwsUpdate.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                        Update on AWS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="Cloud/Azure.html">
            
                
                    <a href="../Cloud/Azure.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.3.</b>
                        
                        Running on Azure
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.4" data-path="Cloud/DockerContainer.html">
            
                
                    <a href="../Cloud/DockerContainer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.4.</b>
                        
                        Docker ArangoDB
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.5" data-path="Cloud/NodeJsDocker.html">
            
                
                    <a href="../Cloud/NodeJsDocker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.5.</b>
                        
                        Docker with NodeJS App
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.6" data-path="Cloud/GiantSwarm.html">
            
                
                    <a href="../Cloud/GiantSwarm.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.6.</b>
                        
                        In the GiantSwarm
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.7" data-path="Cloud/Mesosphere.html">
            
                
                    <a href="../Cloud/Mesosphere.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.7.</b>
                        
                        ArangoDB in Mesos
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="10" data-path="Monitoring/Collectd.html">
            
                
                    <a href="../Monitoring/Collectd.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        Monitoring
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.1" data-path="Monitoring/SlaveStatus.html">
            
                
                    <a href="../Monitoring/SlaveStatus.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.1.</b>
                        
                        Collectd - Replication Slaves
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="10.2" data-path="Monitoring/TrafficWithIPAccounting.html">
            
                
                    <a href="../Monitoring/TrafficWithIPAccounting.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.2.</b>
                        
                        Collectd - Network usage
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="10.3" data-path="Monitoring/OtherRelevantMetrics.html">
            
                
                    <a href="../Monitoring/OtherRelevantMetrics.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.3.</b>
                        
                        Collectd - more Metrics
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="10.4" data-path="Monitoring/FoxxApps.html">
            
                
                    <a href="../Monitoring/FoxxApps.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.4.</b>
                        
                        Collectd - Monitoring Foxx
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >ArangoDB Cookbook</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="foxx-authentication">Foxx Authentication</h1>
<h2 id="problem">Problem</h2>
<p>I want to add authentication to my existing Foxx app: Users need to be able to register, log in and log out. I also want to be able to restrict access to certain routes in my app.</p>
<p><strong>Note:</strong> For this recipe you need at least ArangoDB 2.5. For ArangoDB 2.4 look at the <a href="AuthLegacy.html">old Foxx Authentication</a>.</p>
<h2 id="solution">Solution</h2>
<p>In order to introduce authentication to the todo app we <a href="FirstSteps.html">built</a>, we first need to create a route to register users. In order to do that, we first introduce a new Foxx.Model <em>Credentials</em> with <code>username</code> and <code>password</code>:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> Foxx = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;org/arangodb/foxx&apos;</span>),
  Joi = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;joi&apos;</span>),
  Credentials;

Credentials = Foxx.Model.extend({
  schema: {
    username: Joi.string().required(),
    password: Joi.string().required()
  }
});

exports.Credentials = Credentials;
</code></pre>
<p>In our controller we first require it via <code>Credentials = require(&apos;models/credentials&apos;).Credentials</code>, then we create a new route to register people. Let&apos;s first see that we get all information we require by giving back the username and password. We also set the status code to be a 201 as we will create a new resource.</p>
<pre><code class="lang-js"><span class="hljs-comment">/** Register a new user
 *
 * Add a new user to the system with a given username and password
 */</span>
controller.post(<span class="hljs-string">&apos;/register&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-keyword">var</span> credentials = req.params(<span class="hljs-string">&apos;credentials&apos;</span>),
    username = credentials.get(<span class="hljs-string">&apos;username&apos;</span>),
    password = credentials.get(<span class="hljs-string">&apos;password&apos;</span>);

  res.status(<span class="hljs-number">201</span>);
  res.json({
    username: username,
    password: password
  });
}).bodyParam(<span class="hljs-string">&apos;credentials&apos;</span>, {description: <span class="hljs-string">&apos;Username and Password&apos;</span>, type: Credentials});
</code></pre>
<p>Now we need to have a place to store users. In order to do that, we will use the functionality of two other foxx applications by requiring them. We&apos;re loading the exported APIs of the built-in user and auth apps (we will see what that means in a minute). Like the built-in sessions app, a copy of the user and auth apps are automatically mounted at these mount points by ArangoDB. So all we do in our controller is the following:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> auth = Foxx.requireApp(<span class="hljs-string">&apos;/_system/simple-auth&apos;</span>).auth,
  users = Foxx.requireApp(<span class="hljs-string">&apos;/_system/users&apos;</span>).userStorage;
</code></pre>
<p>We can now use the exports of the two other Foxx apps as <code>auth</code> and <code>users</code>. Let&apos;s use the authentication app to hash and salt our password:</p>
<pre><code class="lang-js">controller.post(<span class="hljs-string">&apos;/register&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-keyword">var</span> credentials = req.params(<span class="hljs-string">&apos;credentials&apos;</span>),
    username = credentials.get(<span class="hljs-string">&apos;username&apos;</span>),
    password = auth.hashPassword(credentials.get(<span class="hljs-string">&apos;password&apos;</span>));

  res.status(<span class="hljs-number">201</span>);
  res.json({
    username: username,
    password: password
  });
}).bodyParam(<span class="hljs-string">&apos;credentials&apos;</span>, {description: <span class="hljs-string">&apos;Username and Password&apos;</span>, type: Credentials});
</code></pre>
<p>Great! Now let&apos;s use our users app to store a new user. The <code>users</code> object has a create method which takes three arguments: The username, a user profile (which we will leave empty for now) and a password object. Let&apos;s create a user:</p>
<pre><code class="lang-js">controller.post(<span class="hljs-string">&apos;/register&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-keyword">var</span> credentials = req.params(<span class="hljs-string">&apos;credentials&apos;</span>),
    username = credentials.get(<span class="hljs-string">&apos;username&apos;</span>),
    password = auth.hashPassword(credentials.get(<span class="hljs-string">&apos;password&apos;</span>)),
    user;

  user = users.create(username, {}, { simple: password });

  res.status(<span class="hljs-number">201</span>);
  res.json({
    username: username
  });
}).bodyParam(<span class="hljs-string">&apos;credentials&apos;</span>, {description: <span class="hljs-string">&apos;Username and Password&apos;</span>, type: Credentials});
</code></pre>
<p>Now create a user with username and password via the route. To see the created user, we will look into the user collection of ArangoDB. First, go to the collections tab. It is a system collection, so we first need to show system collections by clicking on the cogwheel and activating system collections. Then click on the collection users and you will see your new users. Great!</p>
<p>Now let&apos;s clean this up a little. We want to have a helper function that will create users for us and do hashing etc. Let&apos;s create a <code>util</code> folder and create an <code>auth.js</code> file there:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> _ = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;underscore&apos;</span>),
  Foxx = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;org/arangodb/foxx&apos;</span>),
  auth = Foxx.requireApp(<span class="hljs-string">&apos;/_system/simple-auth&apos;</span>).auth,
  users = Foxx.requireApp(<span class="hljs-string">&apos;/_system/users&apos;</span>).userStorage;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createUser</span>(<span class="hljs-params">credentials</span>) </span>{
  <span class="hljs-keyword">var</span> password = auth.hashPassword(credentials.get(<span class="hljs-string">&apos;password&apos;</span>));
  <span class="hljs-keyword">return</span> users.create(credentials.get(<span class="hljs-string">&apos;username&apos;</span>), {}, { simple: password });
}

exports.createUser = createUser;
</code></pre>
<p>This will export a function, that we can now use instead of the other two imports:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> createUser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./util/auth&apos;</span>).createUser;
</code></pre>
<p>And now we can simplify our controller:</p>
<pre><code class="lang-js">controller.post(<span class="hljs-string">&apos;/register&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-keyword">var</span> credentials = req.params(<span class="hljs-string">&apos;credentials&apos;</span>),
    user = createUser(credentials);

  res.status(<span class="hljs-number">201</span>);
  res.json({
    username: user.get(<span class="hljs-string">&apos;user&apos;</span>)
  });
}).bodyParam(<span class="hljs-string">&apos;credentials&apos;</span>, {description: <span class="hljs-string">&apos;Username and Password&apos;</span>, type: Credentials});
</code></pre>
<p>We now have a dedicated place to handle creating and searching for users. It is also a good place for raising exceptions if something goes wrong -- for example if the user is not found. In that case we would catch the exception from the module and translate it into our own, application specific error that we can then add as an errorReponse to the routes in our FoxxController. It is also a good place to put our code to find a user by his or her credentials. But first we need to activate sessions for this controller (in your app, the cookie secret should be something app-specific, <strong>really secret</strong>):</p>
<pre><code class="lang-js">controller.activateSessions({
  type: <span class="hljs-string">&apos;cookie&apos;</span>,
  cookie: {
    secret: <span class="hljs-string">&apos;keep this secret&apos;</span>
  }
});
</code></pre>
<p>Now we can add another utility function to log in a user. It will take the provided credentials and the session. It will throw an error when the credentials are not valid (you can create a file <code>not-logged-in.js</code> in an <code>error</code> folder and require it from both here and the controller) -- otherwise it will set the session data and return the user.</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params">credentials, session</span>) </span>{
  <span class="hljs-keyword">var</span> user = users.resolve(credentials.get(<span class="hljs-string">&apos;username&apos;</span>));
  <span class="hljs-keyword">var</span> valid = auth.verifyPassword(
    user ? user.get(<span class="hljs-string">&apos;authData&apos;</span>).simple : {},
    credentials.get(<span class="hljs-string">&apos;password&apos;</span>)
  );

  <span class="hljs-keyword">if</span> (!valid) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotLoggedIn();
  }

  session.get(<span class="hljs-string">&apos;sessionData&apos;</span>).username = user.get(<span class="hljs-string">&apos;user&apos;</span>);
  session.setUser(user);
  session.save();
  <span class="hljs-keyword">return</span> user;
}

exports.login = login;
</code></pre>
<p>Let&apos;s use this in a new login route:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> login = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./util/auth&apos;</span>).login;

controller.post(<span class="hljs-string">&apos;/login&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-keyword">var</span> credentials = req.params(<span class="hljs-string">&apos;credentials&apos;</span>),
    user = login(credentials, req.session);

  res.status(<span class="hljs-number">201</span>);
  res.json({
    msg: <span class="hljs-string">&apos;Welcome &apos;</span> + user.get(<span class="hljs-string">&apos;user&apos;</span>)
  });
}).bodyParam(<span class="hljs-string">&apos;credentials&apos;</span>, {description: <span class="hljs-string">&apos;Username and Password&apos;</span>, type: Credentials})
  .errorResponse(NotLoggedIn, <span class="hljs-number">401</span>, <span class="hljs-string">&apos;Login failed&apos;</span>);
</code></pre>
<p>And a logout route like that:</p>
<pre><code class="lang-js">controller.destroySession(<span class="hljs-string">&apos;/logout&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  res.json({success: <span class="hljs-literal">true</span>});
});
</code></pre>
<p>And now we have authentication and registration set up. We can now restrict access to logged in users only in any of our routes with <code>.onlyIfAuthenticated();</code> and do more complex things by accessing the session in an <code>onlyIf</code> call. Let&apos;s restrict the access to the list of todos to logged in users:</p>
<pre><code class="lang-js">controller.get(<span class="hljs-string">&apos;/&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
  res.json(_.map(todos.all(), <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">todo</span>) </span>{
    <span class="hljs-keyword">return</span> todo.forClient();
  }));
}).onlyIfAuthenticated();
</code></pre>
<p><strong>Author</strong>: <a href="https://github.com/moonglum" target="_blank">Lucas Dohmen</a></p>
<p><strong>Tags</strong>: #foxx</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../Foxx/FirstStepsLegacy.html" class="navigation navigation-prev " aria-label="Previous page: My first Foxx App pre-2.4"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../Foxx/AuthLegacy.html" class="navigation navigation-next " aria-label="Next page: Adding Authentication pre-2.5"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-toggle-chapters/toggle.js"></script>
    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.1/anchor.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-anchorjs/anchor-style.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-piwik/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"addcssjs":{"js":["styles/header.js"],"css":["styles/header.css"]},"add-header":{"BASE_PATH":"https://docs.arangodb.com/devel"},"piwik":{"URL":"www.arangodb.com/piwik/","siteId":12},"toggle-chapters":{},"anchorjs":{},"highlight":{},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        <!-- body:end -->
<script type="text/javascript">var _paq = _paq || [];_paq.push(['trackPageView']);_paq.push(['enableLinkTracking']);(function() {var u=(("https:" == document.location.protocol) ? "https" : "http") + "://www.arangodb.com/piwik/";_paq.push(['setTrackerUrl', u+'piwik.php']);_paq.push(['setSiteId', 12]);var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';g.defer=true; g.async=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);})();</script><noscript><p><img src="http://www.arangodb.com/piwik/piwik.php?idsite=12" style="border:0;" alt="" /></p></noscript>
    </body>
    <!-- End of book ArangoDB Cookbook -->
</html>
