<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Using Joins in AQL | Cookbook</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.5.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    
        <link rel="stylesheet" href="./styles/website.css">
    

        
    
    
    <link rel="next" href="./UsingDynamicAttributeNames.html" />
    
    
    <link rel="prev" href="./AccessingShapesData.html" />
    

        <script type="text/javascript" src="styles/header.js"></script><link rel="stylesheet" type="text/css" href="styles/header.css">
    </head>
    <body>
        
        
    <div class="book" data-level="3.1" data-chapter-title="Using Joins in AQL" data-filepath="JoinsInAQL.md" data-basepath="." data-revision="Fri Jan 29 2016 14:30:11 GMT+0100 (CET)">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="ModulDocumentInheritance.html">
            
                
                    <a href="./ModulDocumentInheritance.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Modelling Document Inheritance
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="AccessingShapesData.html">
            
                
                    <a href="./AccessingShapesData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Accessing Shapes Data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" >
            
            <span><b>3.</b> AQL</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="3.1" data-path="JoinsInAQL.html">
            
                
                    <a href="./JoinsInAQL.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Using Joins in AQL
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="UsingDynamicAttributeNames.html">
            
                
                    <a href="./UsingDynamicAttributeNames.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Using Dynamic Attribute Names
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="FindingLeafNodesGraph.html">
            
                
                    <a href="./FindingLeafNodesGraph.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Finding Leaf Nodes in a Graph
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="FilteringNodesGraph.html">
            
                
                    <a href="./FilteringNodesGraph.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        Filtering Nodes in a Graph
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="CountingNodesEfficientlyGraph.html">
            
                
                    <a href="./CountingNodesEfficientlyGraph.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Counting Nodes efficiently
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="CreatingTestDataAQL.html">
            
                
                    <a href="./CreatingTestDataAQL.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        Creating Test-data using AQL
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="DiffingDocuments.html">
            
                
                    <a href="./DiffingDocuments.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.7.</b>
                        
                        Diffing Documents
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="AvoidingInjection.html">
            
                
                    <a href="./AvoidingInjection.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.8.</b>
                        
                        Avoiding Parameter Injection
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="MultilineQueryStrings.html">
            
                
                    <a href="./MultilineQueryStrings.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.9.</b>
                        
                        Multiline Query Strings
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" >
            
            <span><b>4.</b> Graph-based Recipes</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="Fulldepth.html">
            
                
                    <a href="./Fulldepth.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Fulldepth Graph-Traversal
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="FindingConnectedVerticesForSubgraphs.html">
            
                
                    <a href="./FindingConnectedVerticesForSubgraphs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Vertices for Subgraphs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="JavaDriverGraphExampleVertex.html">
            
                
                    <a href="./JavaDriverGraphExampleVertex.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        Vertex example with Java
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="JavaDriverBaseDocument.html">
            
                
                    <a href="./JavaDriverBaseDocument.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        Accessing base documents with Java
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="UsingCustomVisitorFromNodeJs.html">
            
                
                    <a href="./UsingCustomVisitorFromNodeJs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        Using a custom Visitor
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="GraphExampleActorsAndMovies.html">
            
                
                    <a href="./GraphExampleActorsAndMovies.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        Example AQL Queries for Graphs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="JavaDriverXmlData.html">
            
                
                    <a href="./JavaDriverXmlData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.</b>
                        
                        Add XML data to ArangoDB with Java
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" >
            
            <span><b>5.</b> Foxx Framework</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="FoxxFirstSteps.html">
            
                
                    <a href="./FoxxFirstSteps.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        My first Foxx App
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="FoxxFirstStepsLegacy.html">
            
                
                    <a href="./FoxxFirstStepsLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        My first Foxx App pre-2.4
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="FoxxAuth.html">
            
                
                    <a href="./FoxxAuth.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        Adding Authentication
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="FoxxAuthLegacy.html">
            
                
                    <a href="./FoxxAuthLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        Adding Authentication pre-2.5
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="MakingRequests.html">
            
                
                    <a href="./MakingRequests.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                        Using external APIs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="FoxxQueues.html">
            
                
                    <a href="./FoxxQueues.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.</b>
                        
                        Background jobs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.7" data-path="FoxxQueuesLegacy.html">
            
                
                    <a href="./FoxxQueuesLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.7.</b>
                        
                        legacy background jobs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.8" data-path="FoxxCustomQueueJobsLegacy.html">
            
                
                    <a href="./FoxxCustomQueueJobsLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.8.</b>
                        
                        legacy custom Background jobs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.9" data-path="FoxxScripts.html">
            
                
                    <a href="./FoxxScripts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.9.</b>
                        
                        Creating a Foxx script
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.10" data-path="FoxxCustomQueueJobs.html">
            
                
                    <a href="./FoxxCustomQueueJobs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.10.</b>
                        
                        Custom job types for Queues
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.11" data-path="FoxxGeneratorFirstSteps.html">
            
                
                    <a href="./FoxxGeneratorFirstSteps.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.11.</b>
                        
                        My first FoxxGenerator App
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.12" data-path="FoxxDeploy.html">
            
                
                    <a href="./FoxxDeploy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.12.</b>
                        
                        How to deploy a Foxx App
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.13" data-path="MakingFoxxAppAccessible.html">
            
                
                    <a href="./MakingFoxxAppAccessible.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.13.</b>
                        
                        Apps accessible from the Web
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.14" data-path="FoxxApiKeys.html">
            
                
                    <a href="./FoxxApiKeys.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.14.</b>
                        
                        API-Key Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.15" data-path="FoxxBinaryFileUploads.html">
            
                
                    <a href="./FoxxBinaryFileUploads.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.15.</b>
                        
                        Handling Binary HTTP documents in Foxx
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.16" data-path="FoxxBinaryHttpPost.html">
            
                
                    <a href="./FoxxBinaryHttpPost.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.16.</b>
                        
                        Sending Binary HTTP documents from Foxx
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.17" data-path="FoxxTesting.html">
            
                
                    <a href="./FoxxTesting.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.17.</b>
                        
                        Foxx Testing
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" >
            
            <span><b>6.</b> Use Cases, Examples</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="CrawlingGithubPromises.html">
            
                
                    <a href="./CrawlingGithubPromises.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Crawling Github with Promises
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="UsingArangoDBWithSailsJS.html">
            
                
                    <a href="./UsingArangoDBWithSailsJS.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        Using ArangoDB with Sails.js
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="PopulatingAnAutocompleteTextbox.html">
            
                
                    <a href="./PopulatingAnAutocompleteTextbox.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.</b>
                        
                        Populating a Textbox
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="ExportingData.html">
            
                
                    <a href="./ExportingData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.4.</b>
                        
                        Exporting Data
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" >
            
            <span><b>7.</b> ArangoDB Setup / Administration</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="UsingAuthentication.html">
            
                
                    <a href="./UsingAuthentication.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        Using Authentication
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="ImportingData.html">
            
                
                    <a href="./ImportingData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                        Importing Data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="ReplicatingData.html">
            
                
                    <a href="./ReplicatingData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.3.</b>
                        
                        Replicating Data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.4" data-path="XCopyInstallWindows.html">
            
                
                    <a href="./XCopyInstallWindows.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.4.</b>
                        
                        XCopy Install Windows
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.5" data-path="Compiling.html">
            
                
                    <a href="./Compiling.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.</b>
                        
                        Compiling / Build
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.5.1" data-path="CompilingOnDebian.html">
            
                
                    <a href="./CompilingOnDebian.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.1.</b>
                        
                        Compile on Debian
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.5.2" data-path="CompilingUnderWindows.html">
            
                
                    <a href="./CompilingUnderWindows.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.2.</b>
                        
                        Compile on Windows
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.5.3" data-path="CompilingUnderWindowsLegacy.html">
            
                
                    <a href="./CompilingUnderWindowsLegacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.3.</b>
                        
                        Compile on Windows pre-2.4
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.5.4" data-path="RunningCustomBuild.html">
            
                
                    <a href="./RunningCustomBuild.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.4.</b>
                        
                        Running Custom Build
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" >
            
            <span><b>8.</b> Cloud, DCOS and Docker</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="RunningOnAWS.html">
            
                
                    <a href="./RunningOnAWS.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        Running on AWS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="UpdateArangoDBOnAWS.html">
            
                
                    <a href="./UpdateArangoDBOnAWS.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        Update on AWS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="UsingArangoDBAzure.html">
            
                
                    <a href="./UsingArangoDBAzure.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                        Running on Azure
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.4" data-path="RunningInDockerContainer.html">
            
                
                    <a href="./RunningInDockerContainer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                        Docker ArangoDB
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.5" data-path="UsingArangoDBNodeJSDocker.html">
            
                
                    <a href="./UsingArangoDBNodeJSDocker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                        Docker with NodeJS App
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.6" data-path="UsingArangoDBInGiantSwarm.html">
            
                
                    <a href="./UsingArangoDBInGiantSwarm.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.</b>
                        
                        In the GiantSwarm
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.7" data-path="UsingArangoDBMesosphere.html">
            
                
                    <a href="./UsingArangoDBMesosphere.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.7.</b>
                        
                        ArangoDB in Mesos
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" >
            
            <span><b>9.</b> Monitoring</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1" data-path="MonitoringWithCollectd.html">
            
                
                    <a href="./MonitoringWithCollectd.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                        Monitoring with Collectd
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="MonitoringSlaveStatus.html">
            
                
                    <a href="./MonitoringSlaveStatus.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                        Collectd - Replication Slaves
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="MonitoringTrafficWithIPAccounting.html">
            
                
                    <a href="./MonitoringTrafficWithIPAccounting.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.3.</b>
                        
                        Collectd - Network usage
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.4" data-path="MonitoringOtherRelevantMetrics.html">
            
                
                    <a href="./MonitoringOtherRelevantMetrics.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.4.</b>
                        
                        Collectd - more Metrics
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.5" data-path="MonitoringFoxxApps.html">
            
                
                    <a href="./MonitoringFoxxApps.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.5.</b>
                        
                        Collectd - Monitoring Foxx
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Cookbook</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="using-joins-in-aql">Using Joins in AQL</h1>
<h2 id="problem">Problem</h2>
<p>I want to join documents from collections in an AQL query.</p>
<ul>
<li><p>One-to-Many: I have a collection users and a collection cities. A user lives in a city and I need the city information during the query.</p>
</li>
<li><p>Many-To-Many: I have a collection authors and books. An author can write many
books and a book can have many authors. I want to return a list of books with
their authors. Therefore I need to join the authors and books.</p>
</li>
</ul>
<h2 id="solution">Solution</h2>
<p>Unlike many NoSQL databases, ArangoDB does support joins in AQL queries. This is
similar to the way traditional relational databases handle this. However,
because documents allow for more flexibility, joins are also more flexible. The
following sections provide solutions for common questions.</p>
<h3 id="onetomany">One-To-Many</h3>
<p>You have a collection called users. Users live in city and a city is identified
by its primary key. In principle you can embedded the city document into the users
document and be happy with it.</p>
<pre><code class="lang-json">{ 
  <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;users/2151975421&quot;</span>, 
  <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2151975421&quot;</span>, 
  <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2151975421&quot;</span>, 
  <span class="hljs-string">&quot;name&quot;</span> : { 
    <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;John&quot;</span>, 
    <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Doe&quot;</span> 
  }, 
  <span class="hljs-string">&quot;city&quot;</span> : { 
    <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;Metropolis&quot;</span> 
  } 
}
</code></pre>
<p>This works well for many use cases. Now assume, that you have additional
information about the city, like the number of people living in it. It would be
impractical to change each and every user document if this numbers
changes. Therefore it is good idea to hold the city information in a separate
collection.</p>
<pre><code class="lang-json">arangosh&gt; db.cities.document(<span class="hljs-string">&quot;cities/2241300989&quot;</span>);
{ 
  <span class="hljs-string">&quot;population&quot;</span> : <span class="hljs-number">1000</span>, 
  <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;Metropolis&quot;</span>, 
  <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;cities/2241300989&quot;</span>, 
  <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2241300989&quot;</span>, 
  <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2241300989&quot;</span> 
}
</code></pre>
<p>Now you instead of embedding the city directly in the user document, you can use
the key of the city.</p>
<pre><code class="lang-json">arangosh&gt; db.users.document(<span class="hljs-string">&quot;users/2290649597&quot;</span>);
{ 
  <span class="hljs-string">&quot;name&quot;</span> : { 
    <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;John&quot;</span>, 
    <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Doe&quot;</span> 
  }, 
  <span class="hljs-string">&quot;city&quot;</span> : <span class="hljs-string">&quot;cities/2241300989&quot;</span>, 
  <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;users/2290649597&quot;</span>, 
  <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2290649597&quot;</span>, 
  <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2290649597&quot;</span> 
}
</code></pre>
<p>We can now join these two collections very easily.</p>
<pre><code class="lang-json">arangosh&gt; db._query(
........&gt;<span class="hljs-string">&quot;FOR u IN users &quot;</span> + 
........&gt;<span class="hljs-string">&quot;  FOR c IN cities &quot;</span> + 
........&gt;<span class="hljs-string">&quot;    FILTER u.city == c._id RETURN { user: u, city: c }&quot;</span>
........&gt;).toArray()
[ 
  { 
    <span class="hljs-string">&quot;user&quot;</span> : { 
      <span class="hljs-string">&quot;name&quot;</span> : { 
        <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;John&quot;</span>, 
        <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Doe&quot;</span> 
      }, 
      <span class="hljs-string">&quot;city&quot;</span> : <span class="hljs-string">&quot;cities/2241300989&quot;</span>, 
      <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;users/2290649597&quot;</span>, 
      <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2290649597&quot;</span>, 
      <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2290649597&quot;</span> 
    }, 
    <span class="hljs-string">&quot;city&quot;</span> : { 
      <span class="hljs-string">&quot;population&quot;</span> : <span class="hljs-number">1000</span>, 
      <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;Metropolis&quot;</span>, 
      <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;cities/2241300989&quot;</span>, 
      <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2241300989&quot;</span>, 
      <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2241300989&quot;</span> 
    } 
  } 
]
</code></pre>
<p>Unlike SQL there is no special JOIN keyword. The optimizer ensures that the
primary index is used in the above query.</p>
<p>However, very often it is much more convenient for the client of the query if a
single document would be returned, where the city information is embedded in the
user document - as in the simple example above.  With AQL there you do not need
to forgo this simplification.</p>
<pre><code class="lang-json">arangosh&gt; db._query(
........&gt;<span class="hljs-string">&quot;FOR u IN users &quot;</span> + 
........&gt;<span class="hljs-string">&quot;  FOR c IN cities &quot;</span> + 
........&gt;<span class="hljs-string">&quot;    FILTER u.city == c._id RETURN merge(u, {city: c})&quot;</span>
........&gt;).toArray()
[ 
  { 
    <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;users/2290649597&quot;</span>, 
    <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2290649597&quot;</span>, 
    <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2290649597&quot;</span>, 
    <span class="hljs-string">&quot;name&quot;</span> : { 
      <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;John&quot;</span>, 
      <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Doe&quot;</span> 
    }, 
    <span class="hljs-string">&quot;city&quot;</span> : { 
      <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;cities/2241300989&quot;</span>, 
      <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2241300989&quot;</span>, 
      <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2241300989&quot;</span>, 
      <span class="hljs-string">&quot;population&quot;</span> : <span class="hljs-number">1000</span>, 
      <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;Metropolis&quot;</span> 
    } 
  } 
]
</code></pre>
<p>So you can have both: the convenient representation of the result for your client
and the flexibility of joins for your data model.</p>
<h3 id="manytomany">Many-To-Many</h3>
<p>In the relational word you need a third table to model the many-to-many
relation. In ArangoDB you have a choice depending on the information you are
going to store and the type of questions you are going to ask.</p>
<p>Assume that authors are stored in one collection and books in a second. If all
you are every interest in is &quot;which are the authors of a book&quot; than you can
easily model this as a list attribute in users.</p>
<p>If you want to store more information, for example which author wrote which page in a conference proceeding, or if you also want to know &quot;which books were writing by which author&quot;, you can use edge collections. This is very similar to the &quot;join table&quot; from the relational world.</p>
<h4 id="embedded-lists">Embedded Lists</h4>
<p>If you only want to store the authors of a book, you can embedded them as list in the book document.  There is no need for a separate collection.</p>
<pre><code class="lang-json">arangosh&gt; db.authors.toArray()
[ 
  { 
    <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2661190141&quot;</span>, 
    <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2661190141&quot;</span>, 
    <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2661190141&quot;</span>, 
    <span class="hljs-string">&quot;name&quot;</span> : { 
      <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;Maxima&quot;</span>, 
      <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Musterfrau&quot;</span> 
    } 
  }, 
  { 
    <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2658437629&quot;</span>, 
    <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2658437629&quot;</span>, 
    <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2658437629&quot;</span>, 
    <span class="hljs-string">&quot;name&quot;</span> : { 
      <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;John&quot;</span>, 
      <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Doe&quot;</span> 
    } 
  } 
]
</code></pre>
<p>You can query books</p>
<pre><code class="lang-json">arangosh&gt; db._query(<span class="hljs-string">&quot;FOR b IN books RETURN b&quot;</span>).toArray();
[ 
  { 
    <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;books/2681506301&quot;</span>, 
    <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2681506301&quot;</span>, 
    <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2681506301&quot;</span>, 
    <span class="hljs-string">&quot;title&quot;</span> : <span class="hljs-string">&quot;The beauty of JOINS&quot;</span>, 
    <span class="hljs-string">&quot;authors&quot;</span> : [ 
      <span class="hljs-string">&quot;authors/2661190141&quot;</span>, 
      <span class="hljs-string">&quot;authors/2658437629&quot;</span> 
    ] 
  } 
]
</code></pre>
<p>and join the authors in a very similar manner given in the one-to-many section.</p>
<pre><code class="lang-json">arangosh&gt; db._query(
........&gt;<span class="hljs-string">&quot;FOR b IN books &quot;</span> +
........&gt;<span class="hljs-string">&quot;  LET a = (FOR x IN b.authors &quot;</span> + 
........&gt;<span class="hljs-string">&quot;             FOR a IN authors FILTER x == a._id RETURN a) &quot;</span> +
........&gt;<span class="hljs-string">&quot;   RETURN { book: b, authors: a }&quot;</span>
........&gt;).toArray();
[ 
  { 
    <span class="hljs-string">&quot;book&quot;</span> : { 
      <span class="hljs-string">&quot;title&quot;</span> : <span class="hljs-string">&quot;The beauty of JOINS&quot;</span>, 
      <span class="hljs-string">&quot;authors&quot;</span> : [ 
        <span class="hljs-string">&quot;authors/2661190141&quot;</span>, 
        <span class="hljs-string">&quot;authors/2658437629&quot;</span> 
      ], 
      <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;books/2681506301&quot;</span>, 
      <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2681506301&quot;</span>, 
      <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2681506301&quot;</span> 
    }, 
    <span class="hljs-string">&quot;authors&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;name&quot;</span> : { 
          <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;Maxima&quot;</span>, 
          <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Musterfrau&quot;</span> 
        }, 
        <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2661190141&quot;</span>, 
        <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2661190141&quot;</span>, 
        <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2661190141&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;name&quot;</span> : { 
          <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;John&quot;</span>, 
          <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Doe&quot;</span> 
        }, 
        <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2658437629&quot;</span>, 
        <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2658437629&quot;</span>, 
        <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2658437629&quot;</span> 
      } 
    ] 
  } 
]
</code></pre>
<p>or embed the authors directly</p>
<pre><code class="lang-json">arangosh&gt; db._query(
........&gt;<span class="hljs-string">&quot;FOR b IN books LET a = (&quot;</span> + 
........&gt;<span class="hljs-string">&quot;     FOR x IN b.authors &quot;</span> + 
........&gt;<span class="hljs-string">&quot;        FOR a IN authors FILTER x == a._id RETURN a)&quot;</span> +
........&gt;<span class="hljs-string">&quot;  RETURN merge(b, { authors: a })&quot;</span>
........&gt;).toArray();
[ 
  { 
    <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;books/2681506301&quot;</span>, 
    <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2681506301&quot;</span>, 
    <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2681506301&quot;</span>, 
    <span class="hljs-string">&quot;title&quot;</span> : <span class="hljs-string">&quot;The beauty of JOINS&quot;</span>, 
    <span class="hljs-string">&quot;authors&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2661190141&quot;</span>, 
        <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2661190141&quot;</span>, 
        <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2661190141&quot;</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : { 
          <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;Maxima&quot;</span>, 
          <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Musterfrau&quot;</span> 
        } 
      }, 
      { 
        <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2658437629&quot;</span>, 
        <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2658437629&quot;</span>, 
        <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2658437629&quot;</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : { 
          <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;John&quot;</span>, 
          <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Doe&quot;</span> 
        } 
      } 
    ] 
  } 
]
</code></pre>
<h4 id="using-edge-collections">Using Edge Collections</h4>
<p>If you also want to query which books are written by a given author, embedding authors
in the book document is possible, but it is more efficient to use a edge collections for
speed.</p>
<p>Or you are publishing a proceeding, then you want to store the pages the author has written
as well. This information can be stored in the edge document.</p>
<p>First create the users</p>
<pre><code class="lang-json">arangosh&gt; db._create(<span class="hljs-string">&quot;authors&quot;</span>);
[ArangoCollection <span class="hljs-number">2926807549</span>, <span class="hljs-string">&quot;authors&quot;</span> (type <span class="hljs-built_in">document</span>, status loaded)]

arangosh&gt; db.authors.save({ name: { first: <span class="hljs-string">&quot;John&quot;</span>, last: <span class="hljs-string">&quot;Doe&quot;</span> } })
{ 
  <span class="hljs-string">&quot;error&quot;</span> : <span class="hljs-literal">false</span>, 
  <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2935261693&quot;</span>, 
  <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2935261693&quot;</span>, 
  <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2935261693&quot;</span> 
}

arangosh&gt; db.authors.save({ name: { first: <span class="hljs-string">&quot;Maxima&quot;</span>, last: <span class="hljs-string">&quot;Musterfrau&quot;</span> } })
{ 
  <span class="hljs-string">&quot;error&quot;</span> : <span class="hljs-literal">false</span>, 
  <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2938210813&quot;</span>, 
  <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2938210813&quot;</span>, 
  <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2938210813&quot;</span> 
}
</code></pre>
<p>Now create the books without any author information.</p>
<pre><code class="lang-json">arangosh&gt; db._create(<span class="hljs-string">&quot;books&quot;</span>);
[ArangoCollection <span class="hljs-number">2928380413</span>, <span class="hljs-string">&quot;books&quot;</span> (type <span class="hljs-built_in">document</span>, status loaded)]

arangosh&gt; db.books.save({ title: <span class="hljs-string">&quot;The beauty of JOINS&quot;</span> });
{ 
  <span class="hljs-string">&quot;error&quot;</span> : <span class="hljs-literal">false</span>, 
  <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;books/2980088317&quot;</span>, 
  <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2980088317&quot;</span>, 
  <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2980088317&quot;</span> 
}
</code></pre>
<p>An edge collection is now used to link authors and books.</p>
<pre><code class="lang-json">arangosh&gt; db._createEdgeCollection(<span class="hljs-string">&quot;written&quot;</span>);
[ArangoCollection <span class="hljs-number">2931132925</span>, <span class="hljs-string">&quot;written&quot;</span> (type edge, status loaded)]

arangosh&gt; db.written.save(<span class="hljs-string">&quot;authors/2935261693&quot;</span>,
........&gt;<span class="hljs-string">&quot;books/2980088317&quot;</span>,
........&gt;{ pages: <span class="hljs-string">&quot;1-10&quot;</span> })
{ 
  <span class="hljs-string">&quot;error&quot;</span> : <span class="hljs-literal">false</span>, 
  <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;written/3006237181&quot;</span>, 
  <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;3006237181&quot;</span>, 
  <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;3006237181&quot;</span> 
}

arangosh&gt; db.written.save(<span class="hljs-string">&quot;authors/2938210813&quot;</span>,
........&gt;<span class="hljs-string">&quot;books/2980088317&quot;</span>,
........&gt;{ pages: <span class="hljs-string">&quot;11-20&quot;</span> })
{ 
  <span class="hljs-string">&quot;error&quot;</span> : <span class="hljs-literal">false</span>, 
  <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;written/3012856317&quot;</span>, 
  <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;3012856317&quot;</span>, 
  <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;3012856317&quot;</span> 
}
</code></pre>
<p>In order to get all books with their authors you can use NEIGHBORS.</p>
<pre><code class="lang-json">arangosh&gt; db._query(
........&gt;<span class="hljs-string">&quot;FOR b IN books RETURN &quot;</span> + 
........&gt;<span class="hljs-string">&quot;  { &quot;</span> +
........&gt;<span class="hljs-string">&quot;    book: b, &quot;</span> +
........&gt;<span class="hljs-string">&quot;    authors: NEIGHBORS(books,&quot;</span> + 
........&gt;<span class="hljs-string">&quot;                       written,&quot;</span> + 
........&gt;<span class="hljs-string">&quot;                       b._id,&quot;</span> + 
........&gt;<span class="hljs-string">&quot;                      &apos;inbound&apos;&quot;</span> +
........&gt;<span class="hljs-string">&quot; ) }&quot;</span>
........&gt;).toArray();
[ 
  { 
    <span class="hljs-string">&quot;book&quot;</span> : { 
      <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;books/2980088317&quot;</span>, 
      <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2980088317&quot;</span>, 
      <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2980088317&quot;</span>, 
      <span class="hljs-string">&quot;title&quot;</span> : <span class="hljs-string">&quot;The beauty of JOINS&quot;</span> 
    }, 
    <span class="hljs-string">&quot;authors&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;edge&quot;</span> : { 
          <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;written/3006237181&quot;</span>, 
          <span class="hljs-string">&quot;_from&quot;</span> : <span class="hljs-string">&quot;authors/2935261693&quot;</span>, 
          <span class="hljs-string">&quot;_to&quot;</span> : <span class="hljs-string">&quot;books/2980088317&quot;</span>, 
          <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;3006237181&quot;</span>, 
          <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;3006237181&quot;</span>, 
          <span class="hljs-string">&quot;pages&quot;</span> : <span class="hljs-string">&quot;1-10&quot;</span> 
        }, 
        <span class="hljs-string">&quot;vertex&quot;</span> : { 
          <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2935261693&quot;</span>, 
          <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2935261693&quot;</span>, 
          <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2935261693&quot;</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : { 
            <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;John&quot;</span>, 
            <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Doe&quot;</span> 
          } 
        } 
      }, 
      { 
        <span class="hljs-string">&quot;edge&quot;</span> : { 
          <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;written/3012856317&quot;</span>, 
          <span class="hljs-string">&quot;_from&quot;</span> : <span class="hljs-string">&quot;authors/2938210813&quot;</span>, 
          <span class="hljs-string">&quot;_to&quot;</span> : <span class="hljs-string">&quot;books/2980088317&quot;</span>, 
          <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;3012856317&quot;</span>, 
          <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;3012856317&quot;</span>, 
          <span class="hljs-string">&quot;pages&quot;</span> : <span class="hljs-string">&quot;11-20&quot;</span> 
        }, 
        <span class="hljs-string">&quot;vertex&quot;</span> : { 
          <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2938210813&quot;</span>, 
          <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2938210813&quot;</span>, 
          <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2938210813&quot;</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : { 
            <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;Maxima&quot;</span>, 
            <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Musterfrau&quot;</span> 
          } 
        } 
      } 
    ] 
  } 
]
</code></pre>
<p>Or if you want to hide the information stored in the edge.</p>
<pre><code class="lang-json">arangosh&gt; db._query(
........&gt;<span class="hljs-string">&quot;FOR b IN books RETURN {&quot;</span> +
........&gt;<span class="hljs-string">&quot;     book: b, authors: &quot;</span> +
........&gt;<span class="hljs-string">&quot;          NEIGHBORS(books, written, b._id, &apos;inbound&apos;)[*].vertex }&quot;</span>
........&gt;).toArray();
[ 
  { 
    <span class="hljs-string">&quot;book&quot;</span> : { 
      <span class="hljs-string">&quot;title&quot;</span> : <span class="hljs-string">&quot;The beauty of JOINS&quot;</span>, 
      <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;books/2980088317&quot;</span>, 
      <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2980088317&quot;</span>, 
      <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2980088317&quot;</span> 
    }, 
    <span class="hljs-string">&quot;authors&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2935261693&quot;</span>, 
        <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2935261693&quot;</span>, 
        <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2935261693&quot;</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : { 
          <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;John&quot;</span>, 
          <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Doe&quot;</span> 
        } 
      }, 
      { 
        <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2938210813&quot;</span>, 
        <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2938210813&quot;</span>, 
        <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2938210813&quot;</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : { 
          <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;Maxima&quot;</span>, 
          <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Musterfrau&quot;</span> 
        } 
      } 
    ] 
  } 
]
</code></pre>
<p>Or again embed the authors directly into the book document.</p>
<pre><code class="lang-json">arangosh&gt; db._query(
........&gt;<span class="hljs-string">&quot;FOR b IN books RETURN merge(&quot;</span> +
........&gt;<span class="hljs-string">&quot;      b, &quot;</span> +
........&gt;<span class="hljs-string">&quot;        {&quot;</span> +
........&gt;<span class="hljs-string">&quot;          authors:&quot;</span> +
........&gt;<span class="hljs-string">&quot;          NEIGHBORS(books, written, b._id, &apos;inbound&apos;)[*].vertex})&quot;</span>
........&gt;).toArray();
[ 
  { 
    <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;books/2980088317&quot;</span>, 
    <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2980088317&quot;</span>, 
    <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2980088317&quot;</span>, 
    <span class="hljs-string">&quot;title&quot;</span> : <span class="hljs-string">&quot;The beauty of JOINS&quot;</span>, 
    <span class="hljs-string">&quot;authors&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2935261693&quot;</span>, 
        <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2935261693&quot;</span>, 
        <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2935261693&quot;</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : { 
          <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;John&quot;</span>, 
          <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Doe&quot;</span> 
        } 
      }, 
      { 
        <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2938210813&quot;</span>, 
        <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2938210813&quot;</span>, 
        <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2938210813&quot;</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : { 
          <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;Maxima&quot;</span>, 
          <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Musterfrau&quot;</span> 
        } 
      } 
    ] 
  } 
]
</code></pre>
<p>If you need the authors and their books, simply reverse the direction.</p>
<pre><code class="lang-json">arangosh&gt; db._query(
........&gt;<span class="hljs-string">&quot;FOR a IN authors RETURN &quot;</span> +
........&gt;<span class="hljs-string">&quot;  merge(a, &quot;</span> +
........&gt;<span class="hljs-string">&quot;        {books: NEIGHBORS(authors, written, a._id, &apos;outbound&apos;)[*].vertex})&quot;</span>
........&gt;).toArray();
[ 
  { 
    <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2938210813&quot;</span>, 
    <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2938210813&quot;</span>, 
    <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2938210813&quot;</span>, 
    <span class="hljs-string">&quot;name&quot;</span> : { 
      <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;Maxima&quot;</span>, 
      <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Musterfrau&quot;</span> 
    }, 
    <span class="hljs-string">&quot;books&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;books/2980088317&quot;</span>, 
        <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2980088317&quot;</span>, 
        <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2980088317&quot;</span>, 
        <span class="hljs-string">&quot;title&quot;</span> : <span class="hljs-string">&quot;The beauty of JOINS&quot;</span> 
      } 
    ] 
  }, 
  { 
    <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;authors/2935261693&quot;</span>, 
    <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2935261693&quot;</span>, 
    <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2935261693&quot;</span>, 
    <span class="hljs-string">&quot;name&quot;</span> : { 
      <span class="hljs-string">&quot;first&quot;</span> : <span class="hljs-string">&quot;John&quot;</span>, 
      <span class="hljs-string">&quot;last&quot;</span> : <span class="hljs-string">&quot;Doe&quot;</span> 
    }, 
    <span class="hljs-string">&quot;books&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;books/2980088317&quot;</span>, 
        <span class="hljs-string">&quot;_rev&quot;</span> : <span class="hljs-string">&quot;2980088317&quot;</span>, 
        <span class="hljs-string">&quot;_key&quot;</span> : <span class="hljs-string">&quot;2980088317&quot;</span>, 
        <span class="hljs-string">&quot;title&quot;</span> : <span class="hljs-string">&quot;The beauty of JOINS&quot;</span> 
      } 
    ] 
  } 
]
</code></pre>
<p><strong>Authors</strong>: <a href="https://github.com/fceller" target="_blank">Frank Celler</a></p>
<p><strong>Tags</strong>: #join #aql</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./AccessingShapesData.html" class="navigation navigation-prev " aria-label="Previous page: Accessing Shapes Data"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./UsingDynamicAttributeNames.html" class="navigation navigation-next " aria-label="Next page: Using Dynamic Attribute Names"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-piwik/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"piwik":{"URL":"www.arangodb.com/piwik/","siteId":12},"addcssjs":{"js":["styles/header.js"],"css":["styles/header.css"]},"highlight":{},"search":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        <script type="text/javascript">var _paq = _paq || [];_paq.push(['trackPageView']);_paq.push(['enableLinkTracking']);(function() {var u=(("https:" == document.location.protocol) ? "https" : "http") + "://www.arangodb.com/piwik/";_paq.push(['setTrackerUrl', u+'piwik.php']);_paq.push(['setSiteId', 12]);var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';g.defer=true; g.async=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);})();</script><noscript><p><img src="http://www.arangodb.com/piwik/piwik.php?idsite=12" style="border:0;" alt="" /></p></noscript>
    </body>
    
</html>
