<!DOCTYPE HTML>
<html lang="en" >
    <!-- Start book ArangoDB v3.0.x-devel (2016-06-02) AQL Documentation -->
    <head>
        <!-- head:start -->
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Optimizing queries | ArangoDB v3.0.x-devel (2016-06-02) AQL Documentation</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        <meta name="author" content="ArangoDB GmbH">
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-toggle-chapters/toggle.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    
        <link rel="stylesheet" href="../styles/website.css">
    

        
    
    
    <link rel="next" href="../ExecutionAndPerformance/QueryCache.html" />
    
    
    <link rel="prev" href="../ExecutionAndPerformance/ExplainingQueries.html" />
    

        <!-- head:end -->
<script type="text/javascript" src="../styles/header.js"></script><link rel="stylesheet" type="text/css" href="../styles/header.css">
    </head>
    <body>
        <!-- body:start -->
<div id="header">
  <div id="logo">
    <a href="https://arangodb.com/">
      <img src="https://docs.arangodb.com/assets/arangodb_logo_2016.png">
    </a>
  </div>
  <div id="logo-small">
    <a href="https://arangodb.com/">
      <img src="https://docs.arangodb.com/assets/arangodb_logo_small_2016.png">
    </a>
  </div>
  <select id="version-switcher">
    <option value="devel">v3.0.x-devel (2016-06-02)</option>
    <option value="2.8">v2.8</option>
    <option value="2.7">v2.7</option>
    <option value="2.6">v2.6</option>
    <option value="2.5">v2.5</option>
    <option value="2.4">v2.4</option>
    <option value="2.3">v2.3</option>
    <option value="2.2">v2.2</option>
    <option value="2.1">v2.1</option>
  </select>
  <div class="google-search">
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
  <ul id="navmenu">
    <li>
      <a href="https://docs.arangodb.com/devel/Manual/index.html">Manual</a>
    </li>
    <li class="active-tab">
      <a href="https://docs.arangodb.com/devel/AQL/index.html">AQL</a>
    </li>
    <li>
      <a href="https://docs.arangodb.com/devel/HTTP/index.html">HTTP</a>
    </li>
    <li>
      <a href="https://docs.arangodb.com/cookbook">Cookbook</a>
    </li>
    <li class="socialIcons">
      <a href="https://github.com/ArangoDB/ArangoDB/issues" target="blank" name="github">
        <i title="GitHub" class="fa fa-github"></i>
      </a>
    </li>
    <li class="socialIcons">
      <a href="http://stackoverflow.com/questions/tagged/arangodb" target="blank" name="stackoverflow">
        <i title="Stackoverflow" class="fa fa-stack-overflow"></i>
      </a>
    </li>
    <li class="socialIcons socialIcons-googlegroups">
      <a href="https://groups.google.com/forum/#!forum/arangodb" target="blank" name="google groups">
        <img title="Google Groups" alt="Google Groups" src="https://docs.arangodb.com/assets/googlegroupsIcon.png" />
      </a>
    </li>
  </ul>
</div>
        
    <div class="book"
        data-level="11.4"
        data-chapter-title="Optimizing queries"
        data-filepath="ExecutionAndPerformance/Optimizer.md"
        data-basepath=".."
        data-revision="Thu Jun 02 2016 11:44:53 GMT+0000 (UTC)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="Invocation/index.html">
            
                
                    <a href="../Invocation/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        How to invoke AQL
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="Invocation/WithArangosh.html">
            
                
                    <a href="../Invocation/WithArangosh.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        with Arangosh
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Invocation/WithWebInterface.html">
            
                
                    <a href="../Invocation/WithWebInterface.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        with the Web Interface
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="Fundamentals/index.html">
            
                
                    <a href="../Fundamentals/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        AQL Fundamentals
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="Fundamentals/Syntax.html">
            
                
                    <a href="../Fundamentals/Syntax.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        AQL Syntax
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="Fundamentals/DataTypes.html">
            
                
                    <a href="../Fundamentals/DataTypes.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Data types
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="Fundamentals/BindParameters.html">
            
                
                    <a href="../Fundamentals/BindParameters.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Bind Parameters
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="Fundamentals/TypeValueOrder.html">
            
                
                    <a href="../Fundamentals/TypeValueOrder.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        Type and value order
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="Fundamentals/DocumentData.html">
            
                
                    <a href="../Fundamentals/DocumentData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        Accessing data from collections
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="Fundamentals/QueryResults.html">
            
                
                    <a href="../Fundamentals/QueryResults.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        Query Results
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="Fundamentals/QueryErrors.html">
            
                
                    <a href="../Fundamentals/QueryErrors.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.7.</b>
                        
                        Query Errors
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="Operators.html">
            
                
                    <a href="../Operators.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Operators
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="DataModification.html">
            
                
                    <a href="../DataModification.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Data Modification Queries
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="Operations/index.html">
            
                
                    <a href="../Operations/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        High level Operations
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="Operations/For.html">
            
                
                    <a href="../Operations/For.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        FOR
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="Operations/Return.html">
            
                
                    <a href="../Operations/Return.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        RETURN
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="Operations/Filter.html">
            
                
                    <a href="../Operations/Filter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        FILTER
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="Operations/Sort.html">
            
                
                    <a href="../Operations/Sort.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        SORT
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="Operations/Limit.html">
            
                
                    <a href="../Operations/Limit.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                        LIMIT
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="Operations/Let.html">
            
                
                    <a href="../Operations/Let.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.</b>
                        
                        LET
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.7" data-path="Operations/Collect.html">
            
                
                    <a href="../Operations/Collect.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.7.</b>
                        
                        COLLECT
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.8" data-path="Operations/Remove.html">
            
                
                    <a href="../Operations/Remove.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.8.</b>
                        
                        REMOVE
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.9" data-path="Operations/Update.html">
            
                
                    <a href="../Operations/Update.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.9.</b>
                        
                        UPDATE
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.10" data-path="Operations/Replace.html">
            
                
                    <a href="../Operations/Replace.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.10.</b>
                        
                        REPLACE
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.11" data-path="Operations/Insert.html">
            
                
                    <a href="../Operations/Insert.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.11.</b>
                        
                        INSERT
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.12" data-path="Operations/Upsert.html">
            
                
                    <a href="../Operations/Upsert.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.12.</b>
                        
                        UPSERT
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="Functions/index.html">
            
                
                    <a href="../Functions/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Functions
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="Functions/TypeCast.html">
            
                
                    <a href="../Functions/TypeCast.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Type cast
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="Functions/String.html">
            
                
                    <a href="../Functions/String.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        String
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="Functions/Numeric.html">
            
                
                    <a href="../Functions/Numeric.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.</b>
                        
                        Numeric
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="Functions/Date.html">
            
                
                    <a href="../Functions/Date.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.4.</b>
                        
                        Date
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.5" data-path="Functions/Array.html">
            
                
                    <a href="../Functions/Array.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.5.</b>
                        
                        Array
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.6" data-path="Functions/Document.html">
            
                
                    <a href="../Functions/Document.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.6.</b>
                        
                        Object / Document
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.7" data-path="Functions/Geo.html">
            
                
                    <a href="../Functions/Geo.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.7.</b>
                        
                        Geo
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.8" data-path="Functions/Fulltext.html">
            
                
                    <a href="../Functions/Fulltext.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.8.</b>
                        
                        Fulltext
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.9" data-path="Functions/Miscellaneous.html">
            
                
                    <a href="../Functions/Miscellaneous.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.9.</b>
                        
                        Miscellaneous
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="Graphs/index.html">
            
                
                    <a href="../Graphs/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Graphs
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="Graphs/Traversals.html">
            
                
                    <a href="../Graphs/Traversals.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        Traversal
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="Graphs/Operations.html">
            
                
                    <a href="../Graphs/Operations.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                        Named Operations
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="Graphs/Functions.html">
            
                
                    <a href="../Graphs/Functions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.3.</b>
                        
                        Other
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" data-path="Advanced/index.html">
            
                
                    <a href="../Advanced/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Advanced Features
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="Advanced/ArrayOperators.html">
            
                
                    <a href="../Advanced/ArrayOperators.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        Array Operators
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="Examples/index.html">
            
                
                    <a href="../Examples/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        Usual Query Patterns
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1" data-path="Examples/Counting.html">
            
                
                    <a href="../Examples/Counting.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                        Counting
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="Examples/DataModificationQueries.html">
            
                
                    <a href="../Examples/DataModificationQueries.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                        Data-modification queries
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="Examples/CombiningQueries.html">
            
                
                    <a href="../Examples/CombiningQueries.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.3.</b>
                        
                        Subqueries
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.4" data-path="Examples/ProjectionsAndFilters.html">
            
                
                    <a href="../Examples/ProjectionsAndFilters.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.4.</b>
                        
                        Projections and filters
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.5" data-path="Examples/Join.html">
            
                
                    <a href="../Examples/Join.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.5.</b>
                        
                        Joins
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.6" data-path="Examples/Grouping.html">
            
                
                    <a href="../Examples/Grouping.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.6.</b>
                        
                        Grouping
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.7" data-path="Examples/CombiningGraphTraversals.html">
            
                
                    <a href="../Examples/CombiningGraphTraversals.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.7.</b>
                        
                        Traversals
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.8" data-path="Examples/QueriesNoCollections.html">
            
                
                    <a href="../Examples/QueriesNoCollections.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.8.</b>
                        
                        Queries without collections
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="10" data-path="Extending/index.html">
            
                
                    <a href="../Extending/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        User Functions
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.1" data-path="Extending/Conventions.html">
            
                
                    <a href="../Extending/Conventions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.1.</b>
                        
                        Conventions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="10.2" data-path="Extending/Functions.html">
            
                
                    <a href="../Extending/Functions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.2.</b>
                        
                        Registering Functions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="11" data-path="ExecutionAndPerformance/index.html">
            
                
                    <a href="../ExecutionAndPerformance/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        Execution and Performance
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="11.1" data-path="ExecutionAndPerformance/QueryStatistics.html">
            
                
                    <a href="../ExecutionAndPerformance/QueryStatistics.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.</b>
                        
                        Query statistics
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="11.2" data-path="ExecutionAndPerformance/ParsingQueries.html">
            
                
                    <a href="../ExecutionAndPerformance/ParsingQueries.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.2.</b>
                        
                        Parsing queries
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="11.3" data-path="ExecutionAndPerformance/ExplainingQueries.html">
            
                
                    <a href="../ExecutionAndPerformance/ExplainingQueries.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.3.</b>
                        
                        Explaining queries
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="11.4" data-path="ExecutionAndPerformance/Optimizer.html">
            
                
                    <a href="../ExecutionAndPerformance/Optimizer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.4.</b>
                        
                        Optimizing queries
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="11.5" data-path="ExecutionAndPerformance/QueryCache.html">
            
                
                    <a href="../ExecutionAndPerformance/QueryCache.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.5.</b>
                        
                        Caching query results
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="12" data-path="CommonErrors.html">
            
                
                    <a href="../CommonErrors.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        Common Errors
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >ArangoDB v3.0.x-devel (2016-06-02) AQL Documentation</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <p><a name="the_aql_query_optimizer"></a></p>
<h1 id="the-aql-query-optimizer">The AQL query optimizer</h1>
<p>AQL queries are sent through an optimizer before execution. The task of the optimizer is
to create an initial execution plan for the query, look for optimization opportunities and
apply them. As a result, the optimizer might produce multiple execution plans for a
single query. It will then calculate the costs for all plans and pick the plan with the
lowest total cost. This resulting plan is considered to be the <em>optimal plan</em>, which is
then executed.</p>
<p>The optimizer is designed to only perform optimizations if they are <em>safe</em>, in the 
meaning that an optimization should not modify the result of a query. A notable exception
to this is that the optimizer is allowed to change the order of results for queries that
do not explicitly specify how results should be sorted.</p>
<p><a name="execution_plans"></a></p>
<h3 id="execution-plans">Execution plans</h3>
<p>The <code>explain</code> command can be used to query the optimal executed plan or even all plans
the optimizer has generated. Additionally, <code>explain</code> can reveal some more information
about the optimizer&apos;s view of the query. </p>
<p><a name="inspecting_plans_using_the_explain_helper"></a></p>
<h3 id="inspecting-plans-using-the-explain-helper">Inspecting plans using the explain helper</h3>
<p>The <code>explain</code> method of <code>ArangoStatement</code> as shown in the next chapters creates very verbose output. 
You can work on the output programmatically, or use this handsome tool that we created
to generate a more human readable representation.</p>
<p>You may use it like this: (we disable syntax highlighting here)</p>
<div id="AQLEXP_01_axplainer_container">
<div id="AQLEXP_01_axplainer_long" onclick="" style="Display: none;">
<pre>
arangosh&gt; db._create(&quot;test&quot;); 
[ArangoCollection 7258, &quot;test&quot; (type document, status loaded)]
arangosh&gt; for (i = 0; i &lt; 100; ++i) { db.test.save({ value: i }); }
arangosh&gt; db.test.ensureIndex({ type: &quot;skiplist&quot;, fields: [ &quot;value&quot; ] });
{ 
  &quot;id&quot; : &quot;test/7562&quot;, 
  &quot;type&quot; : &quot;skiplist&quot;, 
  &quot;fields&quot; : [ 
    &quot;value&quot; 
  ], 
  &quot;unique&quot; : false, 
  &quot;sparse&quot; : false, 
  &quot;isNewlyCreated&quot; : true, 
  &quot;code&quot; : 201 
}
arangosh&gt; var explain = require(&quot;@arangodb/aql/explainer&quot;).explain;
arangosh&gt; explain(&quot;FOR i IN test FILTER i.value &gt; 97 SORT i.value RETURN i.value&quot;, {colors:false});
Query string:
 FOR i IN test FILTER i.value &gt; 97 SORT i.value RETURN i.value

Execution plan:
 Id   NodeType          Est.   Comment
  1   SingletonNode        1   * ROOT
  9   IndexNode           50     - FOR i IN test   /* skiplist index scan */
  5   CalculationNode     50       - LET #3 = i.`value`   /* attribute expression */   /* collections used: i : test */
  8   ReturnNode          50       - RETURN #3

Indexes used:
 By   Type       Collection   Unique   Sparse   Selectivity   Fields        Ranges
  9   skiplist   test         false    false            n/a   [ `value` ]   (i.`value` &gt; 97)

Optimization rules applied:
 Id   RuleName
  1   move-calculations-up
  2   move-filters-up
  3   remove-redundant-calculations
  4   remove-unnecessary-calculations
  5   move-calculations-up-2
  6   move-filters-up-2
  7   use-indexes
  8   remove-filter-covered-by-index
  9   use-index-for-sort

</pre>
</div>
<div id="AQLEXP_01_axplainer_short" onclick="$(&apos;#AQLEXP_01_axplainer_short&apos;).hide(); $(&apos;#AQLEXP_01_axplainer_long&apos;).show();">
<pre>
arangosh&gt; db._create(&quot;test&quot;); 
arangosh&gt; for (i = 0; i &lt; 100; ++i) { db.test.save({ value: i }); }
arangosh&gt; db.test.ensureIndex({ type: &quot;skiplist&quot;, fields: [ &quot;value&quot; ] });
arangosh&gt; var explain = require(&quot;@arangodb/aql/explainer&quot;).explain;
arangosh&gt; explain(&quot;FOR i IN test FILTER i.value &gt; 97 SORT i.value RETURN i.value&quot;, {colors:false});
</pre><div class="example_show_button">show execution results</div>
</div>
</div>




<p><a name="execution_plans_in_detail"></a></p>
<h3 id="execution-plans-in-detail">Execution plans in detail</h3>
<p>Let&apos;s have a look at the raw json output of the same execution plan
using the <code>explain</code> method of <code>ArangoStatement</code>:</p>
<div id="AQLEXP_01_explainCreate_container">
<div id="AQLEXP_01_explainCreate_long" onclick="" style="Display: none;">
<pre>
arangosh&gt; stmt = db._createStatement(<span class="hljs-string">&quot;FOR i IN test FILTER i.value &gt; 97 SORT i.value RETURN i.value&quot;</span>);
[object ArangoStatement]
arangosh&gt; stmt.explain();
{ 
  <span class="hljs-string">&quot;plan&quot;</span> : { 
    <span class="hljs-string">&quot;nodes&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;SingletonNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">1</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">1</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">1</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;IndexNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">1</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">9</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">51</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">50</span>, 
        <span class="hljs-string">&quot;database&quot;</span> : <span class="hljs-string">&quot;_system&quot;</span>, 
        <span class="hljs-string">&quot;collection&quot;</span> : <span class="hljs-string">&quot;test&quot;</span>, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span> 
        }, 
        <span class="hljs-string">&quot;indexes&quot;</span> : [ 
          { 
            <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-string">&quot;7562&quot;</span>, 
            <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;skiplist&quot;</span>, 
            <span class="hljs-string">&quot;fields&quot;</span> : [ 
              <span class="hljs-string">&quot;value&quot;</span> 
            ], 
            <span class="hljs-string">&quot;unique&quot;</span> : <span class="hljs-literal">false</span>, 
            <span class="hljs-string">&quot;sparse&quot;</span> : <span class="hljs-literal">false</span> 
          } 
        ], 
        <span class="hljs-string">&quot;condition&quot;</span> : { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;n-ary or&quot;</span>, 
          <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;n-ary and&quot;</span>, 
              <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
                { 
                  <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;compare &gt;&quot;</span>, 
                  <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
                    { 
                      <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
                      <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
                      <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
                        { 
                          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
                          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
                          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
                        } 
                      ] 
                    }, 
                    { 
                      <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
                      <span class="hljs-string">&quot;value&quot;</span> : <span class="hljs-number">97</span> 
                    } 
                  ] 
                } 
              ] 
            } 
          ] 
        }, 
        <span class="hljs-string">&quot;reverse&quot;</span> : <span class="hljs-literal">false</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;CalculationNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">9</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">5</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">101</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">50</span>, 
        <span class="hljs-string">&quot;expression&quot;</span> : { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
          <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
              <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
            } 
          ] 
        }, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
        }, 
        <span class="hljs-string">&quot;canThrow&quot;</span> : <span class="hljs-literal">false</span>, 
        <span class="hljs-string">&quot;expressionType&quot;</span> : <span class="hljs-string">&quot;attribute&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;ReturnNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">5</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">8</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">151</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">50</span>, 
        <span class="hljs-string">&quot;inVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
        } 
      } 
    ], 
    <span class="hljs-string">&quot;rules&quot;</span> : [ 
      <span class="hljs-string">&quot;move-calculations-up&quot;</span>, 
      <span class="hljs-string">&quot;move-filters-up&quot;</span>, 
      <span class="hljs-string">&quot;remove-redundant-calculations&quot;</span>, 
      <span class="hljs-string">&quot;remove-unnecessary-calculations&quot;</span>, 
      <span class="hljs-string">&quot;move-calculations-up-2&quot;</span>, 
      <span class="hljs-string">&quot;move-filters-up-2&quot;</span>, 
      <span class="hljs-string">&quot;use-indexes&quot;</span>, 
      <span class="hljs-string">&quot;remove-filter-covered-by-index&quot;</span>, 
      <span class="hljs-string">&quot;use-index-for-sort&quot;</span> 
    ], 
    <span class="hljs-string">&quot;collections&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;test&quot;</span>, 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;read&quot;</span> 
      } 
    ], 
    <span class="hljs-string">&quot;variables&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;5&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;1&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span> 
      } 
    ], 
    <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">151</span>, 
    <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">50</span> 
  }, 
  <span class="hljs-string">&quot;warnings&quot;</span> : [ ], 
  <span class="hljs-string">&quot;stats&quot;</span> : { 
    <span class="hljs-string">&quot;rulesExecuted&quot;</span> : <span class="hljs-number">26</span>, 
    <span class="hljs-string">&quot;rulesSkipped&quot;</span> : <span class="hljs-number">0</span>, 
    <span class="hljs-string">&quot;plansCreated&quot;</span> : <span class="hljs-number">1</span> 
  }, 
  <span class="hljs-string">&quot;cacheable&quot;</span> : <span class="hljs-literal">true</span> 
}
</pre>
</div>
<div id="AQLEXP_01_explainCreate_short" onclick="$(&apos;#AQLEXP_01_explainCreate_short&apos;).hide(); $(&apos;#AQLEXP_01_explainCreate_long&apos;).show();">
<pre>
arangosh&gt; stmt = db._createStatement(<span class="hljs-string">&quot;FOR i IN test FILTER i.value &gt; 97 SORT i.value RETURN i.value&quot;</span>);
arangosh&gt; stmt.explain();
</pre><div class="example_show_button">show execution results</div>
</div>
</div>



<p>As you can see, the result details are very verbose so we will not show them in full in the next
sections. Instead, let&apos;s take a closer look at the results step by step.</p>
<p><a name="execution_nodes"></a></p>
<h4 id="execution-nodes">Execution nodes</h4>
<p>In general, an execution plan can be considered to be a pipeline of processing steps.
Each processing step is carried out by a so-called <em>execution node</em></p>
<p>The <code>nodes</code> attribute of the <code>explain</code> result contains these <em>execution nodes</em> in 
the <em>execution plan</em>. The output is still very verbose, so here&apos;s a shorted form of it:</p>
<div id="AQLEXP_02_explainOverview_container">
<div id="AQLEXP_02_explainOverview_long" onclick="" style="Display: none;">
<pre>
arangosh&gt; stmt.explain().plan.nodes.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">node</span>) </span>{ <span class="hljs-keyword">return</span> node.type; });
[ 
  <span class="hljs-string">&quot;SingletonNode&quot;</span>, 
  <span class="hljs-string">&quot;IndexNode&quot;</span>, 
  <span class="hljs-string">&quot;CalculationNode&quot;</span>, 
  <span class="hljs-string">&quot;ReturnNode&quot;</span> 
]
</pre>
</div>
<div id="AQLEXP_02_explainOverview_short" onclick="$(&apos;#AQLEXP_02_explainOverview_short&apos;).hide(); $(&apos;#AQLEXP_02_explainOverview_long&apos;).show();">
<pre>
arangosh&gt; stmt.explain().plan.nodes.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">node</span>) </span>{ <span class="hljs-keyword">return</span> node.type; });
</pre><div class="example_show_button">show execution results</div>
</div>
</div>



<p><em>Note that the list of nodes might slightly change in future versions of ArangoDB if 
new execution node types get added or the optimizer create somewhat more 
optimized plans).</em></p>
<p>When a plan is executed, the query execution engine will start with the node at
the bottom of the list (i.e. the <em>ReturnNode</em>).</p>
<p>The <em>ReturnNode</em>&apos;s purpose is to return data to the caller. It does not produce
data itself, so it will ask the node above itself, this is the <em>CalculationNode</em>
in our example.
<em>CalculationNode</em>s are responsible for evaluating arbitrary expressions. In our
example query, the <em>CalculationNode</em> will evaluate the value of <code>i.value</code>, which
is needed by the <em>ReturnNode</em>. The calculation will be applied for all data the
<em>CalculationNode</em> gets from the node above it, in our example the <em>FilterNode</em>.</p>
<p><em>FilterNode</em>s will only let certain documents pass. Normally, filters are based on
the evaluation of an expression. The filters expression result (<code>i.value &gt; 97</code>)
is calculated in the <em>CalculationNode</em> above the <em>FilterNode</em>.</p>
<p>Finally, all of this needs to be done for documents of collection <code>test</code>. This is
where the <em>IndexNode</em> enters the game. It will use an index (thus its name)
to find certain documents in the collection and ship it down the pipeline in the
order required by <code>SORT i.value</code>. The <em>IndexNode</em> itself has a <em>SingletonNode</em>
as its input. The sole purpose of a <em>SingletonNode</em> node is to provide a single empty
document as input for other processing steps. It is always the end of the pipeline.</p>
<p>Here&apos;s a summary:</p>
<ul>
<li>SingletonNode: produces an empty document as input for other processing steps.</li>
<li>IndexNode: iterates over the index on attribute <code>value</code> in collection <code>test</code>
in the order required by <code>SORT i.value</code>.</li>
<li>CalculationNode: evaluates the result of the calculation <code>i.value &gt; 97</code> to <code>true</code> or <code>false</code></li>
<li>FilterNode: only lets documents pass where above calculation returned <code>true</code></li>
<li>CalculationNode: calculates return value <code>i.value</code></li>
<li>ReturnNode: returns data to the caller</li>
</ul>
<p><a name="optimizer_rules"></a></p>
<h4 id="optimizer-rules">Optimizer rules</h4>
<p>Note that in the example, the optimizer has optimized the <code>SORT</code> statement away.
It can do it safely because there is a sorted skiplist index on <code>i.value</code>, which it has
picked in the <em>IndexNode</em>. As the index values are iterated over in sorted order
anyway, the extra <em>SortNode</em> would have been redundant and was removed.</p>
<p>Additionally, the optimizer has done more work to generate an execution plan that
avoids as much expensive operations as possible. Here is the list of optimizer rules
that were applied to the plan:</p>
<div id="AQLEXP_03_explainRules_container">
<div id="AQLEXP_03_explainRules_long" onclick="" style="Display: none;">
<pre>
arangosh&gt; stmt.explain().plan.rules;
[ 
  <span class="hljs-string">&quot;move-calculations-up&quot;</span>, 
  <span class="hljs-string">&quot;move-filters-up&quot;</span>, 
  <span class="hljs-string">&quot;remove-redundant-calculations&quot;</span>, 
  <span class="hljs-string">&quot;remove-unnecessary-calculations&quot;</span>, 
  <span class="hljs-string">&quot;move-calculations-up-2&quot;</span>, 
  <span class="hljs-string">&quot;move-filters-up-2&quot;</span>, 
  <span class="hljs-string">&quot;use-indexes&quot;</span>, 
  <span class="hljs-string">&quot;remove-filter-covered-by-index&quot;</span>, 
  <span class="hljs-string">&quot;use-index-for-sort&quot;</span> 
]
</pre>
</div>
<div id="AQLEXP_03_explainRules_short" onclick="$(&apos;#AQLEXP_03_explainRules_short&apos;).hide(); $(&apos;#AQLEXP_03_explainRules_long&apos;).show();">
<pre>
arangosh&gt; stmt.explain().plan.rules;
</pre><div class="example_show_button">show execution results</div>
</div>
</div>



<p>Here is the meaning of these rules in context of this query:</p>
<ul>
<li><code>move-calculations-up</code>: moves a <em>CalculationNode</em> as far up in the processing pipeline
as possible</li>
<li><code>move-filters-up</code>: moves a <em>FilterNode</em> as far up in the processing pipeline as 
possible</li>
<li><code>remove-redundant-calculations</code>: replaces references to variables with references to
other variables that contain the exact same result. In the example query, <code>i.value</code>
is calculated multiple times, but each calculation inside a loop iteration would
produce the same value. Therefore, the expression result is shared by several nodes.</li>
<li><code>remove-unnecessary-calculations</code>: removes <em>CalculationNode</em>s whose result values are
not used in the query. In the example this happens due to the <code>remove-redundant-calculations</code>
rule having made some calculations unnecessary.</li>
<li><code>use-index</code>: use an index to iterate over a collection instead of performing a
full collection scan. In the example case this makes sense, as the index can be
used for filtering and sorting.</li>
<li><code>use-index-for-sort</code>: removes a <code>SORT</code> operation if it is already satisfied by 
traversing over a sorted index</li>
</ul>
<p>Note that some rules may appear multiple times in the list, with number suffixes. 
This is due to the same rule being applied multiple times, at different positions 
in the optimizer pipeline.</p>
<p><a name="collections_used_in_a_query"></a></p>
<h4 id="collections-used-in-a-query">Collections used in a query</h4>
<p>The list of collections used in a plan (and query) is contained in the <code>collections</code>
attribute of a plan:</p>
<div id="AQLEXP_04_explainCollections_container">
<div id="AQLEXP_04_explainCollections_long" onclick="" style="Display: none;">
<pre>
arangosh&gt; stmt.explain().plan.collections
[ 
  { 
    <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;test&quot;</span>, 
    <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;read&quot;</span> 
  } 
]
</pre>
</div>
<div id="AQLEXP_04_explainCollections_short" onclick="$(&apos;#AQLEXP_04_explainCollections_short&apos;).hide(); $(&apos;#AQLEXP_04_explainCollections_long&apos;).show();">
<pre>
arangosh&gt; stmt.explain().plan.collections
</pre><div class="example_show_button">show execution results</div>
</div>
</div>



<p>The <code>name</code> attribute contains the name of the <code>collection</code>, and <code>type</code> is the 
access type, which can be either <code>read</code> or <code>write</code>.</p>
<p><a name="variables_used_in_a_query"></a></p>
<h4 id="variables-used-in-a-query">Variables used in a query</h4>
<p>The optimizer will also return a list of variables used in a plan (and query). This
list will contain auxiliary variables created by the optimizer itself. This list
can be ignored by end users in most cases.</p>
<p><a name="cost_of_a_query"></a></p>
<h4 id="cost-of-a-query">Cost of a query</h4>
<p>For each plan the optimizer generates, it will calculate the total cost. The plan 
with the lowest total cost is considered to be the optimal plan. Costs are 
estimates only, as the actual execution costs are unknown to the optimizer. 
Costs are calculated based on heuristics that are hard-coded into execution nodes.
Cost values do not have any unit.</p>
<p><a name="retrieving_all_execution_plans"></a></p>
<h3 id="retrieving-all-execution-plans">Retrieving all execution plans</h3>
<p>To retrieve not just the optimal plan but a list of all plans the optimizer has
generated, set the option <code>allPlans</code> to <code>true</code>:</p>
<p>This will return a list of all plans in the <code>plans</code> attribute instead of in the
<code>plan</code> attribute:</p>
<div id="AQLEXP_05_explainAllPlans_container">
<div id="AQLEXP_05_explainAllPlans_long" onclick="" style="Display: none;">
<pre>
arangosh&gt; stmt.explain({ allPlans: <span class="hljs-literal">true</span> });
{ 
  <span class="hljs-string">&quot;plans&quot;</span> : [ 
    { 
      <span class="hljs-string">&quot;nodes&quot;</span> : [ 
        { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;SingletonNode&quot;</span>, 
          <span class="hljs-string">&quot;dependencies&quot;</span> : [ ], 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">1</span>, 
          <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">1</span>, 
          <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">1</span> 
        }, 
        { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;IndexNode&quot;</span>, 
          <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
            <span class="hljs-number">1</span> 
          ], 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">9</span>, 
          <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">51</span>, 
          <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">50</span>, 
          <span class="hljs-string">&quot;database&quot;</span> : <span class="hljs-string">&quot;_system&quot;</span>, 
          <span class="hljs-string">&quot;collection&quot;</span> : <span class="hljs-string">&quot;test&quot;</span>, 
          <span class="hljs-string">&quot;outVariable&quot;</span> : { 
            <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span>, 
            <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span> 
          }, 
          <span class="hljs-string">&quot;indexes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-string">&quot;7562&quot;</span>, 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;skiplist&quot;</span>, 
              <span class="hljs-string">&quot;fields&quot;</span> : [ 
                <span class="hljs-string">&quot;value&quot;</span> 
              ], 
              <span class="hljs-string">&quot;unique&quot;</span> : <span class="hljs-literal">false</span>, 
              <span class="hljs-string">&quot;sparse&quot;</span> : <span class="hljs-literal">false</span> 
            } 
          ], 
          <span class="hljs-string">&quot;condition&quot;</span> : { 
            <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;n-ary or&quot;</span>, 
            <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
              { 
                <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;n-ary and&quot;</span>, 
                <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
                  { 
                    <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;compare &gt;&quot;</span>, 
                    <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
                      { 
                        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
                        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
                        <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
                          { 
                            <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
                            <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
                            <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
                          } 
                        ] 
                      }, 
                      { 
                        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
                        <span class="hljs-string">&quot;value&quot;</span> : <span class="hljs-number">97</span> 
                      } 
                    ] 
                  } 
                ] 
              } 
            ] 
          }, 
          <span class="hljs-string">&quot;reverse&quot;</span> : <span class="hljs-literal">false</span> 
        }, 
        { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;CalculationNode&quot;</span>, 
          <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
            <span class="hljs-number">9</span> 
          ], 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">5</span>, 
          <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">101</span>, 
          <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">50</span>, 
          <span class="hljs-string">&quot;expression&quot;</span> : { 
            <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
            <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
            <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
              { 
                <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
                <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
                <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
              } 
            ] 
          }, 
          <span class="hljs-string">&quot;outVariable&quot;</span> : { 
            <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
            <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
          }, 
          <span class="hljs-string">&quot;canThrow&quot;</span> : <span class="hljs-literal">false</span>, 
          <span class="hljs-string">&quot;expressionType&quot;</span> : <span class="hljs-string">&quot;attribute&quot;</span> 
        }, 
        { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;ReturnNode&quot;</span>, 
          <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
            <span class="hljs-number">5</span> 
          ], 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">8</span>, 
          <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">151</span>, 
          <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">50</span>, 
          <span class="hljs-string">&quot;inVariable&quot;</span> : { 
            <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
            <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
          } 
        } 
      ], 
      <span class="hljs-string">&quot;rules&quot;</span> : [ 
        <span class="hljs-string">&quot;move-calculations-up&quot;</span>, 
        <span class="hljs-string">&quot;move-filters-up&quot;</span>, 
        <span class="hljs-string">&quot;remove-redundant-calculations&quot;</span>, 
        <span class="hljs-string">&quot;remove-unnecessary-calculations&quot;</span>, 
        <span class="hljs-string">&quot;move-calculations-up-2&quot;</span>, 
        <span class="hljs-string">&quot;move-filters-up-2&quot;</span>, 
        <span class="hljs-string">&quot;use-indexes&quot;</span>, 
        <span class="hljs-string">&quot;remove-filter-covered-by-index&quot;</span>, 
        <span class="hljs-string">&quot;use-index-for-sort&quot;</span> 
      ], 
      <span class="hljs-string">&quot;collections&quot;</span> : [ 
        { 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;test&quot;</span>, 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;read&quot;</span> 
        } 
      ], 
      <span class="hljs-string">&quot;variables&quot;</span> : [ 
        { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;5&quot;</span> 
        }, 
        { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
        }, 
        { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;1&quot;</span> 
        }, 
        { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span> 
        } 
      ], 
      <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">151</span>, 
      <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">50</span> 
    } 
  ], 
  <span class="hljs-string">&quot;warnings&quot;</span> : [ ], 
  <span class="hljs-string">&quot;stats&quot;</span> : { 
    <span class="hljs-string">&quot;rulesExecuted&quot;</span> : <span class="hljs-number">26</span>, 
    <span class="hljs-string">&quot;rulesSkipped&quot;</span> : <span class="hljs-number">0</span>, 
    <span class="hljs-string">&quot;plansCreated&quot;</span> : <span class="hljs-number">1</span> 
  } 
}
</pre>
</div>
<div id="AQLEXP_05_explainAllPlans_short" onclick="$(&apos;#AQLEXP_05_explainAllPlans_short&apos;).hide(); $(&apos;#AQLEXP_05_explainAllPlans_long&apos;).show();">
<pre>
arangosh&gt; stmt.explain({ allPlans: <span class="hljs-literal">true</span> });
</pre><div class="example_show_button">show execution results</div>
</div>
</div>



<p><a name="retrieving_the_plan_as_it_was_generated_by_the_parser_/_lexer"></a></p>
<h3 id="retrieving-the-plan-as-it-was-generated-by-the-parser--lexer">Retrieving the plan as it was generated by the parser / lexer</h3>
<p>To retrieve the plan which closely matches your query, you may turn off most
optimization rules (i.e. cluster rules cannot be disabled if you&apos;re running
the explain on a cluster coordinator) set the option <code>rules</code> to <code>-all</code>:</p>
<p>This will return an unoptimized plan in the <code>plan</code>:</p>
<div id="AQLEXP_06_explainUnoptimizedPlans_container">
<div id="AQLEXP_06_explainUnoptimizedPlans_long" onclick="" style="Display: none;">
<pre>
arangosh&gt; stmt.explain({ optimizer: { rules: [ <span class="hljs-string">&quot;-all&quot;</span> ] } });
{ 
  <span class="hljs-string">&quot;plan&quot;</span> : { 
    <span class="hljs-string">&quot;nodes&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;SingletonNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">1</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">1</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">1</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;EnumerateCollectionNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">1</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">101</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;database&quot;</span> : <span class="hljs-string">&quot;_system&quot;</span>, 
        <span class="hljs-string">&quot;collection&quot;</span> : <span class="hljs-string">&quot;test&quot;</span>, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span> 
        }, 
        <span class="hljs-string">&quot;random&quot;</span> : <span class="hljs-literal">false</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;CalculationNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">2</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">3</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">201</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;expression&quot;</span> : { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;compare &gt;&quot;</span>, 
          <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
              <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
                { 
                  <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
                  <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
                  <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
                } 
              ] 
            }, 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
              <span class="hljs-string">&quot;value&quot;</span> : <span class="hljs-number">97</span> 
            } 
          ] 
        }, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;1&quot;</span> 
        }, 
        <span class="hljs-string">&quot;canThrow&quot;</span> : <span class="hljs-literal">false</span>, 
        <span class="hljs-string">&quot;expressionType&quot;</span> : <span class="hljs-string">&quot;simple&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;FilterNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">3</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">301</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;inVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;1&quot;</span> 
        } 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;CalculationNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">4</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">5</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">401</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;expression&quot;</span> : { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
          <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
              <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
            } 
          ] 
        }, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
        }, 
        <span class="hljs-string">&quot;canThrow&quot;</span> : <span class="hljs-literal">false</span>, 
        <span class="hljs-string">&quot;expressionType&quot;</span> : <span class="hljs-string">&quot;attribute&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;SortNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">5</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">861.5170185988092</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;elements&quot;</span> : [ 
          { 
            <span class="hljs-string">&quot;inVariable&quot;</span> : { 
              <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
            }, 
            <span class="hljs-string">&quot;ascending&quot;</span> : <span class="hljs-literal">true</span> 
          } 
        ], 
        <span class="hljs-string">&quot;stable&quot;</span> : <span class="hljs-literal">false</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;CalculationNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">6</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">7</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">961.5170185988092</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;expression&quot;</span> : { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
          <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
              <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
            } 
          ] 
        }, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;5&quot;</span> 
        }, 
        <span class="hljs-string">&quot;canThrow&quot;</span> : <span class="hljs-literal">false</span>, 
        <span class="hljs-string">&quot;expressionType&quot;</span> : <span class="hljs-string">&quot;attribute&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;ReturnNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">7</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">8</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">1061.517018598809</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;inVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;5&quot;</span> 
        } 
      } 
    ], 
    <span class="hljs-string">&quot;rules&quot;</span> : [ ], 
    <span class="hljs-string">&quot;collections&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;test&quot;</span>, 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;read&quot;</span> 
      } 
    ], 
    <span class="hljs-string">&quot;variables&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;5&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;1&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span> 
      } 
    ], 
    <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">1061.517018598809</span>, 
    <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span> 
  }, 
  <span class="hljs-string">&quot;warnings&quot;</span> : [ ], 
  <span class="hljs-string">&quot;stats&quot;</span> : { 
    <span class="hljs-string">&quot;rulesExecuted&quot;</span> : <span class="hljs-number">0</span>, 
    <span class="hljs-string">&quot;rulesSkipped&quot;</span> : <span class="hljs-number">26</span>, 
    <span class="hljs-string">&quot;plansCreated&quot;</span> : <span class="hljs-number">1</span> 
  }, 
  <span class="hljs-string">&quot;cacheable&quot;</span> : <span class="hljs-literal">true</span> 
}
</pre>
</div>
<div id="AQLEXP_06_explainUnoptimizedPlans_short" onclick="$(&apos;#AQLEXP_06_explainUnoptimizedPlans_short&apos;).hide(); $(&apos;#AQLEXP_06_explainUnoptimizedPlans_long&apos;).show();">
<pre>
arangosh&gt; stmt.explain({ optimizer: { rules: [ <span class="hljs-string">&quot;-all&quot;</span> ] } });
</pre><div class="example_show_button">show execution results</div>
</div>
</div>



<p>Note that some optimizations are already done at parse time (i.e. evaluate simple constant
calculation as <code>1 + 1</code>)</p>
<p><a name="turning_specific_optimizer_rules_off"></a></p>
<h3 id="turning-specific-optimizer-rules-off">Turning specific optimizer rules off</h3>
<p>Optimizer rules can also be turned on or off individually, using the <code>rules</code> attribute.
This can be used to enable or disable one or multiple rules. Rules that shall be enabled
need to be prefixed with a <code>+</code>, rules to be disabled should be prefixed with a <code>-</code>. The
pseudo-rule <code>all</code> matches all rules.</p>
<p>Rules specified in <code>rules</code> are evaluated from left to right, so the following works to
turn on just the one specific rule:</p>
<div id="AQLEXP_07_explainSingleRulePlans_container">
<div id="AQLEXP_07_explainSingleRulePlans_long" onclick="" style="Display: none;">
<pre>
arangosh&gt; stmt.explain({ optimizer: { rules: [ <span class="hljs-string">&quot;-all&quot;</span>, <span class="hljs-string">&quot;+use-index-range&quot;</span> ] } });
{ 
  <span class="hljs-string">&quot;plan&quot;</span> : { 
    <span class="hljs-string">&quot;nodes&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;SingletonNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">1</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">1</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">1</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;EnumerateCollectionNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">1</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">101</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;database&quot;</span> : <span class="hljs-string">&quot;_system&quot;</span>, 
        <span class="hljs-string">&quot;collection&quot;</span> : <span class="hljs-string">&quot;test&quot;</span>, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span> 
        }, 
        <span class="hljs-string">&quot;random&quot;</span> : <span class="hljs-literal">false</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;CalculationNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">2</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">3</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">201</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;expression&quot;</span> : { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;compare &gt;&quot;</span>, 
          <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
              <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
                { 
                  <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
                  <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
                  <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
                } 
              ] 
            }, 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
              <span class="hljs-string">&quot;value&quot;</span> : <span class="hljs-number">97</span> 
            } 
          ] 
        }, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;1&quot;</span> 
        }, 
        <span class="hljs-string">&quot;canThrow&quot;</span> : <span class="hljs-literal">false</span>, 
        <span class="hljs-string">&quot;expressionType&quot;</span> : <span class="hljs-string">&quot;simple&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;FilterNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">3</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">301</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;inVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;1&quot;</span> 
        } 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;CalculationNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">4</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">5</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">401</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;expression&quot;</span> : { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
          <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
              <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
            } 
          ] 
        }, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
        }, 
        <span class="hljs-string">&quot;canThrow&quot;</span> : <span class="hljs-literal">false</span>, 
        <span class="hljs-string">&quot;expressionType&quot;</span> : <span class="hljs-string">&quot;attribute&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;SortNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">5</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">861.5170185988092</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;elements&quot;</span> : [ 
          { 
            <span class="hljs-string">&quot;inVariable&quot;</span> : { 
              <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
            }, 
            <span class="hljs-string">&quot;ascending&quot;</span> : <span class="hljs-literal">true</span> 
          } 
        ], 
        <span class="hljs-string">&quot;stable&quot;</span> : <span class="hljs-literal">false</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;CalculationNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">6</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">7</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">961.5170185988092</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;expression&quot;</span> : { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
          <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
              <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
            } 
          ] 
        }, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;5&quot;</span> 
        }, 
        <span class="hljs-string">&quot;canThrow&quot;</span> : <span class="hljs-literal">false</span>, 
        <span class="hljs-string">&quot;expressionType&quot;</span> : <span class="hljs-string">&quot;attribute&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;ReturnNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">7</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">8</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">1061.517018598809</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;inVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;5&quot;</span> 
        } 
      } 
    ], 
    <span class="hljs-string">&quot;rules&quot;</span> : [ ], 
    <span class="hljs-string">&quot;collections&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;test&quot;</span>, 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;read&quot;</span> 
      } 
    ], 
    <span class="hljs-string">&quot;variables&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;5&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;1&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span> 
      } 
    ], 
    <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">1061.517018598809</span>, 
    <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span> 
  }, 
  <span class="hljs-string">&quot;warnings&quot;</span> : [ ], 
  <span class="hljs-string">&quot;stats&quot;</span> : { 
    <span class="hljs-string">&quot;rulesExecuted&quot;</span> : <span class="hljs-number">0</span>, 
    <span class="hljs-string">&quot;rulesSkipped&quot;</span> : <span class="hljs-number">26</span>, 
    <span class="hljs-string">&quot;plansCreated&quot;</span> : <span class="hljs-number">1</span> 
  }, 
  <span class="hljs-string">&quot;cacheable&quot;</span> : <span class="hljs-literal">true</span> 
}
</pre>
</div>
<div id="AQLEXP_07_explainSingleRulePlans_short" onclick="$(&apos;#AQLEXP_07_explainSingleRulePlans_short&apos;).hide(); $(&apos;#AQLEXP_07_explainSingleRulePlans_long&apos;).show();">
<pre>
arangosh&gt; stmt.explain({ optimizer: { rules: [ <span class="hljs-string">&quot;-all&quot;</span>, <span class="hljs-string">&quot;+use-index-range&quot;</span> ] } });
</pre><div class="example_show_button">show execution results</div>
</div>
</div>



<p>By default, all rules are turned on. To turn off just a few specific rules, use something
like this:</p>
<div id="AQLEXP_08_explainDisableSingleRulePlans_container">
<div id="AQLEXP_08_explainDisableSingleRulePlans_long" onclick="" style="Display: none;">
<pre>
arangosh&gt; stmt.explain({ optimizer: { rules: [ <span class="hljs-string">&quot;-use-index-range&quot;</span>, <span class="hljs-string">&quot;-use-index-for-sort&quot;</span> ] } });
{ 
  <span class="hljs-string">&quot;plan&quot;</span> : { 
    <span class="hljs-string">&quot;nodes&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;SingletonNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">1</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">1</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">1</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;IndexNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">1</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">9</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">51</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">50</span>, 
        <span class="hljs-string">&quot;database&quot;</span> : <span class="hljs-string">&quot;_system&quot;</span>, 
        <span class="hljs-string">&quot;collection&quot;</span> : <span class="hljs-string">&quot;test&quot;</span>, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span> 
        }, 
        <span class="hljs-string">&quot;indexes&quot;</span> : [ 
          { 
            <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-string">&quot;7562&quot;</span>, 
            <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;skiplist&quot;</span>, 
            <span class="hljs-string">&quot;fields&quot;</span> : [ 
              <span class="hljs-string">&quot;value&quot;</span> 
            ], 
            <span class="hljs-string">&quot;unique&quot;</span> : <span class="hljs-literal">false</span>, 
            <span class="hljs-string">&quot;sparse&quot;</span> : <span class="hljs-literal">false</span> 
          } 
        ], 
        <span class="hljs-string">&quot;condition&quot;</span> : { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;n-ary or&quot;</span>, 
          <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;n-ary and&quot;</span>, 
              <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
                { 
                  <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;compare &gt;&quot;</span>, 
                  <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
                    { 
                      <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
                      <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
                      <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
                        { 
                          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
                          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
                          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
                        } 
                      ] 
                    }, 
                    { 
                      <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
                      <span class="hljs-string">&quot;value&quot;</span> : <span class="hljs-number">97</span> 
                    } 
                  ] 
                } 
              ] 
            } 
          ] 
        }, 
        <span class="hljs-string">&quot;reverse&quot;</span> : <span class="hljs-literal">false</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;CalculationNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">9</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">5</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">101</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">50</span>, 
        <span class="hljs-string">&quot;expression&quot;</span> : { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
          <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
              <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
            } 
          ] 
        }, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
        }, 
        <span class="hljs-string">&quot;canThrow&quot;</span> : <span class="hljs-literal">false</span>, 
        <span class="hljs-string">&quot;expressionType&quot;</span> : <span class="hljs-string">&quot;attribute&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;SortNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">5</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">296.6011502714073</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">50</span>, 
        <span class="hljs-string">&quot;elements&quot;</span> : [ 
          { 
            <span class="hljs-string">&quot;inVariable&quot;</span> : { 
              <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
            }, 
            <span class="hljs-string">&quot;ascending&quot;</span> : <span class="hljs-literal">true</span> 
          } 
        ], 
        <span class="hljs-string">&quot;stable&quot;</span> : <span class="hljs-literal">false</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;ReturnNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">6</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">8</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">346.6011502714073</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">50</span>, 
        <span class="hljs-string">&quot;inVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
        } 
      } 
    ], 
    <span class="hljs-string">&quot;rules&quot;</span> : [ 
      <span class="hljs-string">&quot;move-calculations-up&quot;</span>, 
      <span class="hljs-string">&quot;move-filters-up&quot;</span>, 
      <span class="hljs-string">&quot;remove-redundant-calculations&quot;</span>, 
      <span class="hljs-string">&quot;remove-unnecessary-calculations&quot;</span>, 
      <span class="hljs-string">&quot;move-calculations-up-2&quot;</span>, 
      <span class="hljs-string">&quot;move-filters-up-2&quot;</span>, 
      <span class="hljs-string">&quot;use-indexes&quot;</span>, 
      <span class="hljs-string">&quot;remove-filter-covered-by-index&quot;</span> 
    ], 
    <span class="hljs-string">&quot;collections&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;test&quot;</span>, 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;read&quot;</span> 
      } 
    ], 
    <span class="hljs-string">&quot;variables&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;5&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;1&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span> 
      } 
    ], 
    <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">346.6011502714073</span>, 
    <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">50</span> 
  }, 
  <span class="hljs-string">&quot;warnings&quot;</span> : [ ], 
  <span class="hljs-string">&quot;stats&quot;</span> : { 
    <span class="hljs-string">&quot;rulesExecuted&quot;</span> : <span class="hljs-number">25</span>, 
    <span class="hljs-string">&quot;rulesSkipped&quot;</span> : <span class="hljs-number">1</span>, 
    <span class="hljs-string">&quot;plansCreated&quot;</span> : <span class="hljs-number">1</span> 
  }, 
  <span class="hljs-string">&quot;cacheable&quot;</span> : <span class="hljs-literal">true</span> 
}
</pre>
</div>
<div id="AQLEXP_08_explainDisableSingleRulePlans_short" onclick="$(&apos;#AQLEXP_08_explainDisableSingleRulePlans_short&apos;).hide(); $(&apos;#AQLEXP_08_explainDisableSingleRulePlans_long&apos;).show();">
<pre>
arangosh&gt; stmt.explain({ optimizer: { rules: [ <span class="hljs-string">&quot;-use-index-range&quot;</span>, <span class="hljs-string">&quot;-use-index-for-sort&quot;</span> ] } });
</pre><div class="example_show_button">show execution results</div>
</div>
</div>



<p>The maximum number of plans created by the optimizer can also be limited using the 
<code>maxNumberOfPlans</code> attribute:</p>
<div id="AQLEXP_09_explainMaxNumberOfPlans_container">
<div id="AQLEXP_09_explainMaxNumberOfPlans_long" onclick="" style="Display: none;">
<pre>
arangosh&gt; stmt.explain({ maxNumberOfPlans: <span class="hljs-number">1</span> });
{ 
  <span class="hljs-string">&quot;plan&quot;</span> : { 
    <span class="hljs-string">&quot;nodes&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;SingletonNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">1</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">1</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">1</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;EnumerateCollectionNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">1</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">101</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;database&quot;</span> : <span class="hljs-string">&quot;_system&quot;</span>, 
        <span class="hljs-string">&quot;collection&quot;</span> : <span class="hljs-string">&quot;test&quot;</span>, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span> 
        }, 
        <span class="hljs-string">&quot;random&quot;</span> : <span class="hljs-literal">false</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;CalculationNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">2</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">3</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">201</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;expression&quot;</span> : { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;compare &gt;&quot;</span>, 
          <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
              <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
                { 
                  <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
                  <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
                  <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
                } 
              ] 
            }, 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
              <span class="hljs-string">&quot;value&quot;</span> : <span class="hljs-number">97</span> 
            } 
          ] 
        }, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;1&quot;</span> 
        }, 
        <span class="hljs-string">&quot;canThrow&quot;</span> : <span class="hljs-literal">false</span>, 
        <span class="hljs-string">&quot;expressionType&quot;</span> : <span class="hljs-string">&quot;simple&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;FilterNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">3</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">301</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;inVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;1&quot;</span> 
        } 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;CalculationNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">4</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">5</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">401</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;expression&quot;</span> : { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
          <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
              <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
            } 
          ] 
        }, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
        }, 
        <span class="hljs-string">&quot;canThrow&quot;</span> : <span class="hljs-literal">false</span>, 
        <span class="hljs-string">&quot;expressionType&quot;</span> : <span class="hljs-string">&quot;attribute&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;SortNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">5</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">861.5170185988092</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;elements&quot;</span> : [ 
          { 
            <span class="hljs-string">&quot;inVariable&quot;</span> : { 
              <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
            }, 
            <span class="hljs-string">&quot;ascending&quot;</span> : <span class="hljs-literal">true</span> 
          } 
        ], 
        <span class="hljs-string">&quot;stable&quot;</span> : <span class="hljs-literal">false</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;CalculationNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">6</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">7</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">961.5170185988092</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;expression&quot;</span> : { 
          <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;attribute access&quot;</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;value&quot;</span>, 
          <span class="hljs-string">&quot;subNodes&quot;</span> : [ 
            { 
              <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;reference&quot;</span>, 
              <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span>, 
              <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span> 
            } 
          ] 
        }, 
        <span class="hljs-string">&quot;outVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;5&quot;</span> 
        }, 
        <span class="hljs-string">&quot;canThrow&quot;</span> : <span class="hljs-literal">false</span>, 
        <span class="hljs-string">&quot;expressionType&quot;</span> : <span class="hljs-string">&quot;attribute&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;ReturnNode&quot;</span>, 
        <span class="hljs-string">&quot;dependencies&quot;</span> : [ 
          <span class="hljs-number">7</span> 
        ], 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">8</span>, 
        <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">1061.517018598809</span>, 
        <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span>, 
        <span class="hljs-string">&quot;inVariable&quot;</span> : { 
          <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
          <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;5&quot;</span> 
        } 
      } 
    ], 
    <span class="hljs-string">&quot;rules&quot;</span> : [ ], 
    <span class="hljs-string">&quot;collections&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;test&quot;</span>, 
        <span class="hljs-string">&quot;type&quot;</span> : <span class="hljs-string">&quot;read&quot;</span> 
      } 
    ], 
    <span class="hljs-string">&quot;variables&quot;</span> : [ 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">6</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;5&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">4</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;3&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">2</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;1&quot;</span> 
      }, 
      { 
        <span class="hljs-string">&quot;id&quot;</span> : <span class="hljs-number">0</span>, 
        <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;i&quot;</span> 
      } 
    ], 
    <span class="hljs-string">&quot;estimatedCost&quot;</span> : <span class="hljs-number">1061.517018598809</span>, 
    <span class="hljs-string">&quot;estimatedNrItems&quot;</span> : <span class="hljs-number">100</span> 
  }, 
  <span class="hljs-string">&quot;warnings&quot;</span> : [ ], 
  <span class="hljs-string">&quot;stats&quot;</span> : { 
    <span class="hljs-string">&quot;rulesExecuted&quot;</span> : <span class="hljs-number">0</span>, 
    <span class="hljs-string">&quot;rulesSkipped&quot;</span> : <span class="hljs-number">26</span>, 
    <span class="hljs-string">&quot;plansCreated&quot;</span> : <span class="hljs-number">1</span> 
  }, 
  <span class="hljs-string">&quot;cacheable&quot;</span> : <span class="hljs-literal">true</span> 
}
</pre>
</div>
<div id="AQLEXP_09_explainMaxNumberOfPlans_short" onclick="$(&apos;#AQLEXP_09_explainMaxNumberOfPlans_short&apos;).hide(); $(&apos;#AQLEXP_09_explainMaxNumberOfPlans_long&apos;).show();">
<pre>
arangosh&gt; stmt.explain({ maxNumberOfPlans: <span class="hljs-number">1</span> });
</pre><div class="example_show_button">show execution results</div>
</div>
</div>



<p><a name="optimizer_statistics"></a></p>
<h3 id="optimizer-statistics">Optimizer statistics</h3>
<p>The optimizer will return statistics as a part of an <code>explain</code> result.</p>
<p>The following attributes will be returned in the <code>stats</code> attribute of an <code>explain</code> result:</p>
<ul>
<li><code>plansCreated</code>: total number of plans created by the optimizer</li>
<li><code>rulesExecuted</code>: number of rules executed (note: an executed rule does not 
indicate a plan was actually modified by a rule)</li>
<li><code>rulesSkipped</code>: number of rules skipped by the optimizer</li>
</ul>
<p><a name="warnings"></a></p>
<h3 id="warnings">Warnings</h3>
<p>For some queries, the optimizer may produce warnings. These will be returned in
the <code>warnings</code> attribute of the <code>explain</code> result:</p>
<div id="AQLEXP_10_explainWarn_container">
<div id="AQLEXP_10_explainWarn_long" onclick="" style="Display: none;">
<pre>
arangosh&gt; <span class="hljs-keyword">var</span> stmt = db._createStatement(<span class="hljs-string">&quot;FOR i IN 1..10 RETURN 1 / 0&quot;</span>)
arangosh&gt; stmt.explain().warnings;
[ 
  { 
    <span class="hljs-string">&quot;code&quot;</span> : <span class="hljs-number">1562</span>, 
    <span class="hljs-string">&quot;message&quot;</span> : <span class="hljs-string">&quot;division by zero&quot;</span> 
  } 
]
</pre>
</div>
<div id="AQLEXP_10_explainWarn_short" onclick="$(&apos;#AQLEXP_10_explainWarn_short&apos;).hide(); $(&apos;#AQLEXP_10_explainWarn_long&apos;).show();">
<pre>
arangosh&gt; <span class="hljs-keyword">var</span> stmt = db._createStatement(<span class="hljs-string">&quot;FOR i IN 1..10 RETURN 1 / 0&quot;</span>)
arangosh&gt; stmt.explain().warnings;
</pre><div class="example_show_button">show execution results</div>
</div>
</div>



<p>There is an upper bound on the number of warning a query may produce. If that
bound is reached, no further warnings will be returned.</p>
<p><a name="list_of_execution_nodes"></a></p>
<h3 id="list-of-execution-nodes">List of execution nodes</h3>
<p>The following execution node types will appear in the output of <code>explain</code>:</p>
<ul>
<li><em>SingletonNode</em>: the purpose of a <em>SingletonNode</em> is to produce an empty document
that is used as input for other processing steps. Each execution plan will contain
exactly one <em>SingletonNode</em> as its top node.</li>
<li><em>EnumerateCollectionNode</em>: enumeration over documents of a collection (given in
its <em>collection</em> attribute) without using an index.</li>
<li><em>IndexNode</em>: enumeration over one or many indexes (given in its <em>indexes</em> attribute)
of a collection. The index ranges are specified in the <em>condition</em> attribute of the node.</li>
<li><em>EnumerateListNode</em>: enumeration over a list of (non-collection) values.</li>
<li><em>FilterNode</em>: only lets values pass that satisfy a filter condition. Will appear once
per <em>FILTER</em> statement.</li>
<li><em>LimitNode</em>: limits the number of results passed to other processing steps. Will
appear once per <em>LIMIT</em> statement.</li>
<li><em>CalculationNode</em>: evaluates an expression. The expression result may be used by
other nodes, e.g. <em>FilterNode</em>, <em>EnumerateListNode</em>, <em>SortNode</em> etc.</li>
<li><em>SubqueryNode</em>: executes a subquery.</li>
<li><em>SortNode</em>: performs a sort of its input values.</li>
<li><em>AggregateNode</em>: aggregates its input and produces new output variables. This will
appear once per <em>COLLECT</em> statement.</li>
<li><em>ReturnNode</em>: returns data to the caller. Will appear in each read-only query at
least once. Subqueries will also contain <em>ReturnNode</em>s.</li>
<li><em>InsertNode</em>: inserts documents into a collection (given in its <em>collection</em> 
attribute). Will appear exactly once in a query that contains an <em>INSERT</em> statement.</li>
<li><em>RemoveNode</em>: removes documents from a collection (given in its <em>collection</em> 
attribute). Will appear exactly once in a query that contains a <em>REMOVE</em> statement.</li>
<li><em>ReplaceNode</em>: replaces documents in a collection (given in its <em>collection</em> 
attribute). Will appear exactly once in a query that contains a <em>REPLACE</em> statement.</li>
<li><em>UpdateNode</em>: updates documents in a collection (given in its <em>collection</em> 
attribute). Will appear exactly once in a query that contains an <em>UPDATE</em> statement.</li>
<li><em>UpsertNode</em>: upserts documents in a collection (given in its <em>collection</em> 
attribute). Will appear exactly once in a query that contains an <em>UPSERT</em> statement.</li>
<li><em>NoResultsNode</em>: will be inserted if <em>FILTER</em> statements turn out to be never
satisfiable. The <em>NoResultsNode</em> will pass an empty result set into the processing
pipeline. </li>
</ul>
<p>For queries in the cluster, the following nodes may appear in execution plans:</p>
<ul>
<li><em>ScatterNode</em>: used on a coordinator to fan-out data to one or multiple shards.</li>
<li><em>GatherNode</em>: used on a coordinator to aggregate results from one or many shards
into a combined stream of results.</li>
<li><em>DistributeNode</em>: used on a coordinator to fan-out data to one or multiple shards,
taking into account a collection&apos;s shard key.</li>
<li><em>RemoteNode</em>: a <em>RemoteNode</em> will perform communication with another ArangoDB
instances in the cluster. For example, the cluster coordinator will need to 
communicate with other servers to fetch the actual data from the shards. It 
will do so via <em>RemoteNode</em>s. The data servers themselves might again pull
further data from the coordinator, and thus might also employ <em>RemoteNode</em>s.
So, all of the above cluster relevant nodes will be accompanied by a <em>RemoteNode</em>.</li>
</ul>
<p><a name="list_of_optimizer_rules"></a></p>
<h3 id="list-of-optimizer-rules">List of optimizer rules</h3>
<p>The following optimizer rules may appear in the <code>rules</code> attribute of a plan:</p>
<ul>
<li><code>move-calculations-up</code>: will appear if a <em>CalculationNode</em> was moved up in a plan. 
The intention of this rule is to move calculations up in the processing pipeline
as far as possible (ideally out of enumerations) so they are not executed in loops
if not required. It is also quite common that this rule enables further optimizations
to kick in.</li>
<li><code>move-filters-up</code>: will appear if a <em>FilterNode</em> was moved up in a plan. The
intention of this rule is to move filters up in the processing pipeline as far
as possible (ideally out of inner loops) so they filter results as early as possible.</li>
<li><code>sort-in-values</code>: will appear when the values used as right-hand side of an <code>IN</code>
operator will be pre-sorted using an extra function call. Pre-sorting the comparison
array allows using a binary search in-list lookup with a logarithmic complexity instead 
of the default linear complexity in-list lookup.</li>
<li><code>remove-unnecessary-filters</code>: will appear if a <em>FilterNode</em> was removed or replaced.
<em>FilterNode</em>s whose filter condition will always evaluate to <em>true</em> will be
removed from the plan, whereas <em>FilterNode</em> that will never let any results pass
will be replaced with a <em>NoResultsNode</em>.</li>
<li><code>remove-redundant-calculations</code>: will appear if redundant calculations (expressions
with the exact same result) were found in the query. The optimizer rule will then
replace references to the redundant expressions with a single reference, allowing
other optimizer rules to remove the then-unneeded <em>CalculationNode</em>s.</li>
<li><code>remove-unnecessary-calculations</code>: will appear if <em>CalculationNode</em>s were removed
from the query. The rule will removed all calculations whose result is not 
referenced in the query (note that this may be a consequence of applying other
optimizations).</li>
<li><code>remove-redundant-sorts</code>: will appear if multiple <em>SORT</em> statements can be merged
into fewer sorts.</li>
<li><code>interchange-adjacent-enumerations</code>: will appear if a query contains multiple 
<em>FOR</em> statements whose order were permuted. Permutation of <em>FOR</em> statements is
performed because it may enable further optimizations by other rules.</li>
<li><code>remove-sort-rand</code>: will appear when a <em>SORT RAND()</em> expression is removed by
moving the random iteration into an <em>EnumerateCollectionNode</em>.</li>
<li><code>remove-collect-variables</code>: will appear if an <em>INTO</em> clause was removed from a <em>COLLECT</em>
statement because the result of <em>INTO</em> is not used. May also appear if a result
of a <em>COLLECT</em> statement&apos;s <em>AGGREGATE</em> variables is not used.</li>
<li><code>propagate-constant-attributes</code>: will appear when a constant value was inserted
into a filter condition, replacing a dynamic attribute value.</li>
<li><code>replace-or-with-in</code>: will appear if multiple <em>OR</em>-combined equality conditions 
on the same variable or attribute were replaced with an <em>IN</em> condition.</li>
<li><code>remove-redundant-or</code>: will appear if multiple <em>OR</em> conditions for the same variable
or attribute were combined into a single condition.</li>
<li><code>use-indexes</code>: will appear when an index is used to iterate over a collection.
As a consequence, an <em>EnumerateCollectionNode</em> was replaced with an 
<em>IndexNode</em> in the plan.</li>
<li><code>remove-filters-covered-by-index</code>: will appear if a <em>FilterNode</em> was removed or replaced
because the filter condition is already covered by an <em>IndexNode</em>.</li>
<li><code>use-index-for-sort</code>: will appear if an index can be used to avoid a <em>SORT</em> 
operation. If the rule was applied, a <em>SortNode</em> was removed from the plan.</li>
<li><code>move-calculations-down</code>: will appear if a <em>CalculationNode</em> was moved down in a plan. 
The intention of this rule is to move calculations down in the processing pipeline
as far as possible (below <em>FILTER</em>, <em>LIMIT</em> and <em>SUBQUERY</em> nodes) so they are executed 
as late as possible and not before their results are required.</li>
<li><code>patch-update-statements</code>: will appear if an <em>UpdateNode</em> was patched to not buffer
its input completely, but to process it in smaller batches. The rule will fire for an
<em>UPDATE</em> query that is fed by a full collection scan, and that does not use any other
indexes and subqueries.</li>
<li><code>optimize-traversals</code>: will appear if either the edge or path output variable in an
AQL traversal was optimized away, or if a <em>FILTER</em> condition from the query was moved
in the <em>TraversalNode</em> for early pruning of results.</li>
<li><code>inline-subqueries</code>: will appear when a subquery was pulled out in its surrounding scope,
e.g. <code>FOR x IN (FOR y IN collection FILTER y.value &gt;= 5 RETURN y.test) RETURN x.a</code> 
would become <code>FOR tmp IN collection FILTER tmp.value &gt;= 5 LET x = tmp.test RETURN x.a</code> </li>
</ul>
<p>The following optimizer rules may appear in the <code>rules</code> attribute of cluster plans:</p>
<ul>
<li><code>distribute-in-cluster</code>: will appear when query parts get distributed in a cluster.
This is not an optimization rule, and it cannot be turned off. </li>
<li><code>scatter-in-cluster</code>: will appear when scatter, gather, and remote nodes are inserted
into a distributed query. This is not an optimization rule, and it cannot be turned off.</li>
<li><code>distribute-filtercalc-to-cluster</code>: will appear when filters are moved up in a 
distributed execution plan. Filters are moved as far up in the plan as possible to 
make result sets as small as possible as early as possible.</li>
<li><code>distribute-sort-to-cluster</code>: will appear if sorts are moved up in a distributed query.
Sorts are moved as far up in the plan as possible to make result sets as small as possible 
as early as possible.</li>
<li><code>remove-unnecessary-remote-scatter</code>: will appear if a RemoteNode is followed by a
ScatterNode, and the ScatterNode is only followed by calculations or the SingletonNode.
In this case, there is no need to distribute the calculation, and it will be handled
centrally.</li>
<li><code>undistribute-remove-after-enum-coll</code>: will appear if a RemoveNode can be pushed into
the same query part that enumerates over the documents of a collection. This saves
inter-cluster roundtrips between the EnumerateCollectionNode and the RemoveNode.</li>
</ul>
<p>Note that some rules may appear multiple times in the list, with number suffixes. 
This is due to the same rule being applied multiple times, at different positions 
in the optimizer pipeline.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../ExecutionAndPerformance/ExplainingQueries.html" class="navigation navigation-prev " aria-label="Previous page: Explaining queries"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../ExecutionAndPerformance/QueryCache.html" class="navigation navigation-next " aria-label="Next page: Caching query results"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-toggle-chapters/toggle.js"></script>
    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.1/anchor.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-anchorjs/anchor-style.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-piwik/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"addcssjs":{"js":["styles/header.js"],"css":["styles/header.css"]},"add-header":{"BASE_PATH":"https://docs.arangodb.com/devel"},"piwik":{"URL":"www.arangodb.com/piwik/","siteId":12},"toggle-chapters":{},"anchorjs":{},"highlight":{},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        <!-- body:end -->
<script type="text/javascript">var _paq = _paq || [];_paq.push(['trackPageView']);_paq.push(['enableLinkTracking']);(function() {var u=(("https:" == document.location.protocol) ? "https" : "http") + "://www.arangodb.com/piwik/";_paq.push(['setTrackerUrl', u+'piwik.php']);_paq.push(['setSiteId', 12]);var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';g.defer=true; g.async=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);})();</script><noscript><p><img src="http://www.arangodb.com/piwik/piwik.php?idsite=12" style="border:0;" alt="" /></p></noscript>
    </body>
    <!-- End of book ArangoDB v3.0.x-devel (2016-06-02) AQL Documentation -->
</html>
